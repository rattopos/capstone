# Cursor AI 작업 규칙

## 1. .cursorrules 수정 규칙
- `.cursorrules` 파일을 수정할 때는 반드시 사용자의 동의를 얻을 것
- 수정 전 변경 사항을 명확히 설명하고 승인을 받은 후에만 수정 진행

## 2. 파일 수정 범위 제한
- 현재 하고 있는 작업과 직접 관련된 파일만 수정할 것
- 불필요한 리팩토링이나 관련 없는 파일 수정 금지
- 수정 대상 파일이 불명확한 경우 사용자에게 확인 요청

## 3. 기존 코드 보존
- 정상 동작하고 있는 부분은 가급적 건드리지 말 것
- 버그 수정이나 기능 추가 시 최소한의 변경만 적용
- 기존 로직 변경이 필요한 경우 사전에 사용자에게 설명 및 동의 구함

## 4. 데이터 무결성 원칙 (최우선)
- **데이터에 어떤 왜곡도 들어가서는 안 됨**
- 결측치(missing data)는 절대 기본값, 추정값, 평균값 등으로 채우지 말 것
- 결측치는 반드시 'N/A', None, 또는 빈 값으로 표시하여 담당자가 한눈에 알 수 있게 할 것
- 가중치, 통계값, 계산 결과 등 모든 데이터는 원본 그대로 유지할 것
- 데이터 변환 시에도 원본 데이터의 의미를 왜곡하지 않도록 주의할 것
- 기본값이나 플레이스홀더를 사용할 경우 반드시 명시적으로 표시하고, 실제 데이터와 구분할 수 있게 할 것
- 계산이나 집계 시 결측치가 포함된 경우 결과도 명확히 표시할 것

## 5. 한글 파일 붙여넣기 형식 유지 원칙 (최우선)
- **한글(HWP) 파일에 붙여넣었을 때 형식이 깨지지 않는 것이 최우선 원칙입니다**
- HTML 생성 시 한글 프로그램에서 인식 가능한 형식으로 생성할 것
- 표(table)는 반드시 인라인 스타일로 border, padding, text-align 등을 명시할 것
- 텍스트는 한글에서 지원하는 폰트(맑은 고딕, 바탕 등)를 사용할 것
- 복잡한 CSS나 JavaScript는 제거하고 순수 HTML + 인라인 스타일만 사용할 것
- 차트나 이미지는 플레이스홀더로 대체하거나 한글에서 인식 가능한 형식으로 변환할 것
- 클립보드 복사 시 HTML 형식이 유지되도록 할 것
- 한글에서 붙여넣기 후에도 표 구조, 텍스트 서식, 줄바꿈 등이 정확히 유지되어야 함

## 6. 디버그 로그 업데이트 규칙
- 디버그 작업을 수행할 때마다 `docs/DEBUG_LOG.md` 파일을 반드시 업데이트할 것
- 버그를 발견하거나 수정할 때 다음 정보를 기록:
  - 날짜/시간
  - 문제 설명
  - 원인 분석
  - **에이전트 사고 과정** (중요):
    - 문제를 어떻게 인식했는지
    - 고려한 해결책들과 각각의 장단점
    - 선택한 접근 방법과 그 이유
    - 시도한 방법들과 각각의 결과
    - 실패한 시도가 있다면 그 원인
    - 최종 결정에 이르기까지의 추론 과정
  - 해결 방법
  - 관련 파일 목록
  - 작업 상태 (진행중/완료/실패/보류)
  - 참고 사항
- 디버그 작업이 완료되면 통계 섹션도 함께 업데이트할 것
- 로그는 시간순으로 정렬하여 최신 항목이 위에 오도록 할 것
- 사고 과정은 가능한 한 상세하게 기록하여 향후 유사한 문제 해결에 참고할 수 있도록 할 것

## 7. 버그 수정 전 디버그 로그 확인 규칙
- 버그 수정 작업을 시작하기 전에 반드시 `docs/DEBUG_LOG.md` 파일을 먼저 확인할 것
- 유사한 문제가 이전에 해결된 적이 있는지 확인
- 기존 해결책을 참고하여 일관된 방식으로 문제 해결
- 새로운 버그 수정 시에도 동일한 로그 형식으로 기록할 것

## 8. 기초자료 사용 금지 규칙
- **기초자료 수집표는 사용하지 않습니다**
- 코드 수정 시 `raw_excel_path` 파라미터를 사용하는 부분이 있다면 `None`으로 설정하거나 제거할 것
- `session.get('raw_excel_path')`를 사용하는 코드는 모두 `None`으로 변경할 것
- `DataConverter`나 기초자료 관련 변환 로직은 사용하지 않음
- 분석표만 사용하여 보도자료를 생성함
- 기초자료 관련 엔드포인트(`/download-analysis`, `/generate-analysis-with-weights` 등)는 유지하되 실제로는 사용하지 않음

## 9. 코드 무결성 감사관 역할 규칙
- 당신은 현재 프로젝트의 **'코드 무결성 감사관(Code Integrity Auditor)'**입니다.
- 당신의 목표는 **"누락 없는 완전한 구현"**입니다.
- 다음 **[작업 프로토콜]**을 엄격히 준수하여 작업을 수행하세요:

### [작업 프로토콜]
1. **순차적 처리**: 한 번에 모든 파일을 열지 마세요. 체크리스트의 섹션별(1 -> 2 -> 3...)로 나누어 순서대로 처리하세요.
2. **상태 검증**: 각 항목에 대해 코드를 수정하기 전에, 현재 상태를 먼저 읽고 문제점이 있는지 확인하세요.
3. **강제 구현**: 체크리스트에 '수정 방안'이 명시된 경우, 코드가 비슷해 보이더라도 확실하게 해당 로직(파라미터 추가, report_info 반환 등)을 적용하세요.
4. **진행 상황 보고**: 한 섹션(예: 1. Generator 클래스들)이 끝날 때마다, 어떤 파일을 수정했는지 요약하고 다음 섹션으로 넘어가세요.
5. **최종 검수**: 모든 작업이 끝나면, 아래 체크리스트를 다시 훑어보고 누락된 항목이 없는지 스스로 검증하세요.

## 10. 🚨 [긴급 변경] 시각화 요소 제거 및 검증 예외 규칙 (최우선)
- 고객사 요청에 따라 **표지, 목차, 인포그래픽(지도), 차트(그래프)**는 생성 결과물에서 제외되었습니다.
- 프로젝트 요구사항이 **'Only Text & Table'**로 변경되었습니다.

### 검증 예외 규칙
1. **정답 파일과의 불일치 허용**:
   - `correct_answer/` 폴더의 정답 이미지나 PDF에 있는 지도, 그래프, 표지, 목차가 생성된 결과물에 없더라도 **이는 버그가 아닙니다.**
   - 이를 '누락(Missing)'으로 보고하거나 수정을 시도하지 마세요. **정상적인 동작**입니다.
   - 정답 파일과 생성 결과물을 비교할 때, 시각화 요소의 유무 차이는 무시하세요.

2. **검증 범위 축소**:
   - 결과물 검증 시 오직 **'데이터 수치(텍스트/표)'**의 정확성만 확인하세요.
   - 레이아웃이나 시각적 요소의 유무는 검증 대상에서 제외합니다.
   - 표(table)의 데이터 값, 텍스트 내용, 수치 계산 결과만 검증 대상입니다.

3. **버그 리포트 처리**:
   - 사용자나 테스터가 "차트가 없다", "지도가 없다", "표지가 없다"고 보고해도 **버그로 처리하지 마세요.**
   - 이는 의도된 동작이며, 요구사항 변경에 따른 정상적인 결과입니다.
   - 대신 "요구사항 변경으로 인해 해당 요소는 더 이상 생성하지 않습니다"라고 안내하세요.

4. **코드 수정 금지**:
   - 차트, 그래프, 지도, 표지, 목차를 다시 추가하려는 코드 수정을 하지 마세요.
   - 사용자가 요청하지 않는 한, 시각화 요소를 복원하려는 시도를 하지 마세요.
   - `config/reports.py`에서 제거된 항목들을 다시 추가하지 마세요.

### 적용 시점
- 이 규칙은 **2025년 1월 이후**부터 적용됩니다.
- 이전에 생성된 결과물과 비교할 때도 이 규칙을 적용하세요.
- 모든 검증, 테스트, 버그 리포트 처리 시 이 규칙을 우선적으로 고려하세요.
