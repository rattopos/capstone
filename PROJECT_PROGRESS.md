# 📊 지역경제동향 보고서 자동 생성 시스템
## 캡스톤 프로젝트 진행사항 보고서

---

## 📌 프로젝트 개요

| 항목 | 내용 |
|------|------|
| **프로젝트명** | 지역경제동향 보고서 자동 생성 시스템 |
| **의뢰 기관** | 국가데이터처 (Ministry of Data and Statistics) |
| **개발 기간** | 2025년 12월 11일 ~ 12월 26일 (약 2주) |
| **총 커밋 수** | 130+개 |
| **기술 스택** | Python, Flask, Jinja2, Pandas, OpenPyXL |

---

## 🎯 프로젝트 목표

국가데이터처의 **"지역경제동향"** 분기별 보고서 작성 업무를 자동화하여:

1. 📉 **작업 시간 단축**: 수작업으로 수일 걸리던 작업을 분 단위로 단축
2. 🎯 **오류 감소**: 수기 입력 시 발생하는 오타 및 숫자 오류 방지
3. 📋 **표준화**: 일관된 포맷과 스타일의 보고서 생성
4. 🔄 **재현성**: 동일한 입력에 대해 동일한 출력 보장

---

## 📈 개발 타임라인 (Git 커밋 기반)

### Phase 1: 초기 구축 (12/11 ~ 12/12)
> **핵심**: 기본 구조 설계 및 스키마 정의

| 날짜 | 주요 내용 | 커밋 ID |
|------|----------|---------|
| 12/11 | Initial commit - 프로젝트 초기화 | `13c17f9` |
| 12/12 | 스키마 구조 설계 및 추가 | `c2d7c32`, `2e2f8b4` |

**성과물**:
- 프로젝트 기본 구조 수립
- 데이터 스키마(JSON) 설계 체계 구축

---

### Phase 2: 알파 버전 개발 (12/15)
> **핵심**: 핵심 기능 프로토타입 구현

| 날짜 | 주요 내용 | 커밋 ID |
|------|----------|---------|
| 12/15 | 알파 버전 출시 | `631d5e7` |
| 12/15 | 문장 단순화 로직 구현 | `adbb1cb` |
| 12/15 | 수치 완전 일치 검증 | `e80e8f5` |
| 12/15 | 웹 버전 및 템플릿 모듈화 | `eae6c7a` |
| 12/15 | 프론트엔드 개선 | `5605fe7` |

**성과물**:
- 엑셀 데이터 파싱 엔진
- 기본 HTML 템플릿 시스템
- 정답 데이터와 수치 일치 검증 완료

---

### Phase 3: 웹 애플리케이션 구현 (12/16 ~ 12/17)
> **핵심**: Flask 기반 대시보드 개발

| 날짜 | 주요 내용 | 커밋 ID |
|------|----------|---------|
| 12/16 | 웹 애플리케이션 추가 | `6e2b995` |
| 12/16 | UI 개선 | `ccd7bac` |
| 12/16 | 다양한 시트 수치 일치 | `e32bd9f`, `74fd920` |
| 12/17 | 사진 기반 템플릿 생성기 추가 | `029f655` |
| 12/17 | 파싱 알고리즘 개선 | `925f38b` |
| 12/17 | 템플릿 생성 매핑 개편 | `5447ef6` |
| 12/17 | 의미 기반 마커 시스템 도입 | `df2a6f3` |
| 12/17 | 부문별 지역경제 동향 모든 템플릿 제작 | `ba7511b` |

**성과물**:
- Flask 웹 대시보드
- 드래그 앤 드롭 파일 업로드
- 10개 부문별 보고서 템플릿 완성
- 의미 기반 마커 시스템 (이전 위치 기반에서 전환)

---

### Phase 4: 고도화 및 기능 확장 (12/18 ~ 12/21)
> **핵심**: 스키마 기반 아키텍처 전환 및 가중치 기반 순위 시스템

| 날짜 | 주요 내용 | 커밋 ID |
|------|----------|---------|
| 12/18 | 결측치 처리 개선 | `2efb7f6` |
| 12/18 | 엑셀 파일 읽기 오류 해결 | `b586fe5` |
| 12/18 | PDF 생성 기능 구현 | `52d4aa0` |
| 12/18 | 알고리즘 개선 | `6c5a47c` |
| 12/21 | **스키마 기반 아키텍처 전환** | `a118de7` |
| 12/21 | 가중치 기반 순위 스키마 추가 | `162f0d3` |
| 12/21 | 템플릿 동적 변수 처리 | `1484185` |

**성과물**:
- JSON 스키마 기반 데이터 추출 시스템
- 가중치 기반 시도별 순위 자동 계산
- 증감 방향 동적 변수 처리
- PDF 출력 기능

---

### Phase 5: 품질 개선 및 안정화 (12/22 ~ 12/23)
> **핵심**: 템플릿 정밀도 향상 및 모듈화

| 날짜 | 주요 내용 | 커밋 ID |
|------|----------|---------|
| 12/22 | 물가동향 품목성질별 시트 변경 | `b1f4fa3` |
| 12/22 | 수입/수출 결측치 처리 개선 | `d0b63d1` |
| 12/22 | 캐싱을 통한 성능 최적화 | `843655a` |
| 12/23 | 소스 파일 모듈화 구조 개선 | `0d2c366` |
| 12/23 | 실업률 템플릿 구현 완료 | `155712d` |
| 12/23 | 서울 템플릿 동적 랭킹 마커 패턴 구현 | `51ecc13` |
| 12/23 | DOCX 생성 및 다운로드 기능 수정 | `1cbe506` |

**성과물**:
- 10개 부문별 템플릿 완전 구현
- 시도별 순위 동적 계산 시스템
- 코드 모듈화 (config, utils, services, routes)

---

### Phase 6: 대시보드 완성 (12/25)
> **핵심**: 웹 대시보드 기능 완성 및 UX 개선

| 날짜 | 주요 내용 | 커밋 ID |
|------|----------|---------|
| 12/25 | 웹 애플리케이션 대시보드 구현 | `0924cdf` |
| 12/25 | 지역경제동향 보고서 자동 생성 시스템 구현 | `992e94b` |
| 12/25 | 통계표를 개별 항목으로 분리 | `8fb84cc` |
| 12/25 | 페이지 편집 기능 및 HWPX 내보내기 기능 추가 | `25df489` |
| 12/25 | 기초자료→분석표 변환 개선 및 UI 업데이트 | `aa67317` |
| 12/25 | 분석표 생성 시 연도/분기 범위 동적 계산 | `b094a41` |
| 12/25 | 결측치/비공개 정보를 노란색 형광펜 플레이스홀더로 표시 | `a6fbe09` |

**성과물**:
- 완성된 웹 대시보드 UI
- 4개 탭 구조 (요약/부문별/시도별/통계표)
- 결측치 시각적 표시 (노란색 형광펜)
- HWPX 파일 내보내기

---

### Phase 7: 코드 정리 및 국제화 (12/26)
> **핵심**: 파일명 영문화 및 최종 정리

| 날짜 | 주요 내용 | 커밋 ID |
|------|----------|---------|
| 12/26 | 템플릿 데이터 및 미리보기 파일 업데이트 | `5d17fbf` |
| 12/26 | app.py, generators, templates 및 유틸리티 스크립트 추가 | `69736a4` |
| 12/26 | generators, app.py, data_converter 업데이트 및 인포그래픽 템플릿 추가 | `f0242a3` |
| 12/26 | **템플릿 파일명 한글→영문 변경** | `ebc69c2` |

**성과물**:
- 템플릿 파일명 영문화 (유지보수성 향상)
- 인포그래픽 템플릿 추가
- KOSIS GRDP 데이터 연동 모듈

---

### Phase 8: 기능 고도화 및 UX 개선 (12/27 ~ 12/30)
> **핵심**: 이중 프로세스 구조 확립 및 출력 포맷 개선

| 날짜 | 주요 내용 | 커밋 ID |
|------|----------|---------|
| 12/27 | 요약 차트를 Chart.js 복합 차트로 변경 | `1781d26` |
| 12/27 | 통계표 데이터 추출 기능 수정 | `37ed229` |
| 12/27 | 가중치 비공개(0) 기본값 대체 기능 및 설정 UI 추가 | `26e0ec1` |
| 12/28 | 분석표 생성을 다운로드 시점으로 변경 | `ee9f26f` |
| 12/28 | 파일 업로드 후 자동 미리보기 생성, 미리보기 버튼 제거 | `49ba178` |
| 12/29 | **한글 복붙용 HTML 내보내기 기능 구현** | `dbf899e` |
| 12/29 | HTML 보도자료를 PDF 출력용으로 최적화 | `79e71ae` |
| 12/29 | 분석 시트 없을 때 기초자료에서 직접 데이터 추출 | `ab6c9c4` |
| 12/30 | 검토완료 시 결측치 하이라이트 제거 | `6c008db` |
| 12/30 | 서비스업생산 템플릿 두 페이지로 분리 | `bce5a91` |

**성과물**:
- **이중 프로세스 구조**: 프로세스 1 (기초자료→분석표), 프로세스 2 (분석표+GRDP→보고서)
- **한글 복붙용 HTML**: HWPX 대신 복사-붙여넣기 최적화 HTML 생성 [[memory:12693155]]
- **가중치 설정 UI**: 비공개(0) 값 자동 대체 기능
- **자동 미리보기**: 파일 업로드 시 즉시 보고서 미리보기
- **Chart.js 복합 차트**: 요약 페이지 막대+점 복합 차트

---

## 🏗️ 시스템 아키텍처

```
┌─────────────────────────────────────────────────────────────────┐
│                    Flask 웹 애플리케이션                         │
│                       (app.py)                                  │
├─────────────────────────────────────────────────────────────────┤
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐          │
│  │   routes/    │  │  services/   │  │   utils/     │          │
│  │              │  │              │  │              │          │
│  │ • main.py    │  │ • report_    │  │ • filters.py │          │
│  │ • api.py     │  │   generator  │  │ • excel_     │          │
│  │ • preview.py │  │ • grdp_      │  │   utils.py   │          │
│  │              │  │   service    │  │ • data_      │          │
│  │              │  │ • summary_   │  │   utils.py   │          │
│  │              │  │   data       │  │              │          │
│  └──────────────┘  └──────────────┘  └──────────────┘          │
├─────────────────────────────────────────────────────────────────┤
│  ┌──────────────┐  ┌──────────────────────────────────────────┐│
│  │   config/    │  │              templates/                   ││
│  │              │  │                                           ││
│  │ • settings   │  │ • *_template.html (71개 HTML 템플릿)      ││
│  │ • reports    │  │ • *_generator.py  (15개 생성기)           ││
│  │              │  │ • *_schema.json   (39개 스키마)           ││
│  └──────────────┘  └──────────────────────────────────────────┘│
└─────────────────────────────────────────────────────────────────┘
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                        입력 데이터                              │
│  ┌────────────────────┐  ┌────────────────────┐                │
│  │  분석표 엑셀       │  │  기초자료 수집표   │                │
│  │  (.xlsx)           │  │  (.xlsx)           │                │
│  └────────────────────┘  └────────────────────┘                │
└─────────────────────────────────────────────────────────────────┘
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                        출력 결과                                │
│  ┌────────────┐ ┌────────────┐ ┌────────────┐ ┌────────────┐  │
│  │   HTML     │ │ 한글복붙용 │ │   Excel    │ │   PDF      │  │
│  │ (미리보기) │ │   HTML     │ │ (분석표)   │ │ (인쇄용)   │  │
│  └────────────┘ └────────────┘ └────────────┘ └────────────┘  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 📄 생성 가능한 보고서 목록

### 1. 요약 보고서 (9개)
| # | 보고서 ID | 보고서명 | 설명 |
|---|-----------|----------|------|
| 1 | cover | 표지 | 보고서 표지 |
| 2 | guide | 일러두기 | 보고서 이용 안내 |
| 3 | toc | 목차 | 전체 목차 |
| 4 | infographic | 인포그래픽 | 주요 지표 시각화 |
| 5 | summary_overview | 요약-지역경제동향 | 전체 경제 요약 |
| 6 | summary_production | 요약-생산 | 생산 부문 요약 |
| 7 | summary_consumption | 요약-소비건설 | 소비/건설 요약 |
| 8 | summary_trade_price | 요약-수출물가 | 수출입/물가 요약 |
| 9 | summary_employment | 요약-고용인구 | 고용/인구 요약 |

### 2. 부문별 보고서 (10개)
| # | 보고서 ID | 보고서명 | 엑셀 시트 |
|---|-----------|----------|-----------|
| 1 | manufacturing | 광공업생산 | A 분석 |
| 2 | service | 서비스업생산 | B 분석 |
| 3 | consumption | 소비동향 | C 분석 |
| 4 | construction | 건설동향 | F'분석 |
| 5 | export | 수출 | G 분석 |
| 6 | import | 수입 | H 분석 |
| 7 | price | 물가동향 | E(품목성질물가)분석 |
| 8 | employment | 고용률 | D(고용률)분석 |
| 9 | unemployment | 실업률 | D(실업)분석 |
| 10 | population | 국내인구이동 | I(순인구이동)집계 |

### 3. 시도별 보고서 (18개)
| # | 지역 | 설명 |
|---|------|------|
| 1~17 | 17개 시도 | 서울, 부산, 대구, 인천, 광주, 대전, 울산, 세종, 경기, 강원, 충북, 충남, 전북, 전남, 경북, 경남, 제주 |
| 18 | 참고_GRDP | 분기 지역내총생산(GRDP) |

### 4. 통계표 (13개)
| # | 통계표 ID | 통계표명 |
|---|-----------|----------|
| 1 | stat_toc | 통계표-목차 |
| 2 | stat_mining | 광공업생산지수 |
| 3 | stat_service | 서비스업생산지수 |
| 4 | stat_retail | 소매판매액지수 |
| 5 | stat_construction | 건설수주액 |
| 6 | stat_employment | 고용률 |
| 7 | stat_unemployment | 실업률 |
| 8 | stat_population | 국내인구이동 |
| 9 | stat_export | 수출액 |
| 10 | stat_import | 수입액 |
| 11 | stat_price | 소비자물가지수 |
| 12 | stat_grdp | 참고-GRDP |
| 13 | stat_appendix | 부록-주요용어정의 |

**총 보고서 수: 50개**

---

## 🔧 주요 기술적 성과

### 1. 스키마 기반 데이터 추출
```
분석표 엑셀 → JSON 스키마 → 템플릿 렌더링 → HTML 출력
```
- 각 보고서마다 `*_schema.json` 파일로 데이터 매핑 정의
- 시트명, 행/열 위치, 데이터 타입 명세
- 새로운 보고서 추가 시 스키마만 작성하면 됨

### 2. 가중치 기반 순위 시스템
- 17개 시도의 경제지표를 실시간 분석
- 증감률에 가중치를 적용하여 순위 자동 계산
- 상위/하위 지역 자동 하이라이트

### 3. 결측치 처리 시스템
- 누락된 데이터를 노란색 형광펜으로 시각화
- 사용자가 직접 수정 가능한 `contenteditable` 필드
- 결측치 목록을 모달창으로 한눈에 확인

### 4. 다중 출력 포맷 지원
| 포맷 | 용도 | 구현 방식 |
|------|------|----------|
| HTML | 웹 미리보기 | Jinja2 템플릿 |
| 한글 복붙용 HTML | 한글 문서 붙여넣기 | 테이블 최적화 HTML |
| PDF용 HTML | 인쇄/PDF 저장 | A4 페이지 분할 |
| Excel | 분석표 자동 생성 | OpenPyXL (수식 보존) |

### 5. 모듈화된 코드 구조
```
capstone/
├── config/         # 설정 및 상수
├── routes/         # API 엔드포인트
├── services/       # 비즈니스 로직
├── utils/          # 유틸리티 함수
└── templates/      # HTML 템플릿 및 생성기
```

---

## 📊 개발 통계

| 항목 | 수량 |
|------|------|
| 총 Git 커밋 | 130+개 |
| HTML 템플릿 | 71개 |
| Python 생성기 | 15개 |
| JSON 스키마 | 39개 |
| API 엔드포인트 | 10+ 개 |
| 지원 보고서 | 50개 |
| 개발 기간 | 16일 |

---

## 🖥️ 대시보드 기능

### 메인 화면 구성
```
┌────────────────────────────────────────────────────────────────┐
│  📊 지역경제동향 보고서 생성 시스템                            │
├────────────────────────────────────────────────────────────────┤
│  [📁 분석표 업로드]     [연도▼] [분기▼]    [분석표 다운로드]   │
├──────────────────────┬─────────────────────────────────────────┤
│                      │                                         │
│  [요약][부문별][시도별][통계표]                                 │
│                      │                                         │
│  ├─ 📑 표지          │     ┌─────────────────────────────┐    │
│  ├─ 📖 일러두기      │     │                             │    │
│  ├─ 📋 목차          │     │     미 리 보 기 영 역       │    │
│  ├─ 📊 인포그래픽    │     │                             │    │
│  ├─ 📈 요약-지역경제 │     │                             │    │
│  └─ ...              │     │                             │    │
│                      │     └─────────────────────────────┘    │
│                      │                                         │
│                      │     [◀ 이전]     [다음 ▶]              │
└──────────────────────┴─────────────────────────────────────────┘
```

### 주요 기능
1. **드래그 앤 드롭 업로드**: 분석표 엑셀 파일 간편 업로드
2. **실시간 미리보기**: 클릭 즉시 보고서 미리보기 표시
3. **페이지 네비게이션**: 이전/다음 버튼으로 순차 탐색
4. **결측치 알림**: 누락된 데이터 실시간 감지 및 표시
5. **분석표 자동 생성**: 기초자료에서 분석표 엑셀 자동 생성
6. **내보내기**: HWPX, HTML 등 다양한 포맷 지원

---

## 🚀 실행 방법

```bash
# 1. 가상환경 활성화
source VENV/bin/activate

# 2. 서버 실행
python app.py

# 3. 브라우저 접속
# http://localhost:5050
```

---

## 📝 향후 개선 과제

| 우선순위 | 과제 | 설명 |
|----------|------|------|
| 🔴 높음 | KOSIS API 연동 | 실시간 통계 데이터 자동 수집 |
| 🟡 중간 | 차트 자동 생성 | 그래프 이미지 동적 생성 |
| 🟡 중간 | 버전 관리 | 보고서 버전 히스토리 관리 |
| 🟢 낮음 | 다국어 지원 | 영문 보고서 생성 |
| 🟢 낮음 | 사용자 권한 | 로그인 및 권한 관리 |

---

## 👥 기여자

| 역할 | 담당 |
|------|------|
| 개발 | 캡스톤 프로젝트 팀 |
| 기획 | 국가데이터처 |

---

## 📚 참고 자료

- [프로젝트 제안서](./11기%20캡스톤%20프로젝트%20제안서_통계청.pdf)
- [정답 이미지](./correct_answer/) - 목표 보고서 이미지
- [Flask 공식 문서](https://flask.palletsprojects.com/)
- [Jinja2 템플릿 문서](https://jinja.palletsprojects.com/)

---

<div align="center">

**Built with ❤️ for 국가데이터처**

*Last Updated: 2025년 12월 30일*

</div>

