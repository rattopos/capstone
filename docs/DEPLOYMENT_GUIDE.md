# 📦 지역경제동향 보도자료 생성 시스템
## 배포 및 설치 가이드

> 설치, 설정, 문제 해결을 위한 종합 배포 문서  
> 작성일: 2026년 1월 1일

---

## 📋 목차

1. [빠른 시작](#1-빠른-시작)
2. [상세 설치 가이드](#2-상세-설치-가이드)
3. [문제 해결 가이드](#3-문제-해결-가이드)
4. [Windows 배포 이슈](#4-windows-배포-이슈)
5. [자주 묻는 질문](#5-자주-묻는-질문)

---

# 1. 빠른 시작

> 이 페이지만 보시면 프로그램을 바로 사용할 수 있습니다!

## 🆕 처음 사용하시나요?

```
1️⃣  C:\지역경제동향시스템 폴더 열기

2️⃣  "초기설정" 더블클릭

3️⃣  "예" 클릭 (권한 요청 시)

4️⃣  설정 완료까지 대기 (2~3분)

5️⃣  완료! 바탕화면에 아이콘 생성됨
```

## 📊 매일 사용하기

```
1️⃣  바탕화면 "보도자료생성" 아이콘 더블클릭

2️⃣  웹 브라우저 자동 열림 (5초 대기)

3️⃣  파일 업로드 → 보도자료 생성

4️⃣  종료: 검은 창 닫기
```

## ❗ 문제 발생 시

| 상황 | 해결 |
|------|------|
| 파란 경고창 | `추가 정보` → `실행` 클릭 |
| "예/아니오" 창 | `예` 클릭 |
| 브라우저 안 열림 | 주소창에 `localhost:5000` 입력 |
| 기타 문제 | [문제 해결 가이드](#3-문제-해결-가이드) 참고 |

---

# 2. 상세 설치 가이드

> 처음 프로그램을 설치하는 분들을 위한 안내서

## 📋 시작하기 전 확인사항

프로그램을 사용하려면 컴퓨터에 다음이 설치되어 있어야 합니다:

| 항목 | 확인 방법 | 없으면? |
|------|----------|---------|
| ✅ Microsoft Excel | 엑셀 파일을 열 수 있으면 OK | IT 담당자에게 설치 요청 |
| ✅ 인터넷 연결 | 웹 브라우저가 열리면 OK | 네트워크 담당자에게 문의 |

## 🚀 처음 설치하기 (한 번만 하면 됩니다)

### 1단계: 프로그램 폴더 확인

1. 전달받은 **"지역경제동향시스템"** 폴더를 **C드라이브**에 복사합니다
2. 폴더 위치가 `C:\지역경제동향시스템` 인지 확인합니다

```
📁 C:\지역경제동향시스템
   ├── 📁 VENV (건드리지 마세요)
   ├── 📁 templates (건드리지 마세요)
   ├── 📁 uploads (건드리지 마세요)
   ├── 📄 app.py (건드리지 마세요)
   ├── 📄 초기설정.bat ← 이것을 실행!
   └── 📄 보도자료생성.bat ← 매일 사용할 파일
```

### 2단계: 초기 설정 (딱 한 번만!)

> ⏱️ 소요시간: 약 2~3분

1. `C:\지역경제동향시스템` 폴더를 엽니다
2. **"초기설정"** 파일을 찾아서 **더블클릭**합니다
3. **"Windows의 PC 보호"** 창이 나타나면:
   - `추가 정보` 글자를 클릭합니다
   - `실행` 버튼을 클릭합니다
4. **"사용자 계정 컨트롤"** 창이 나타나면:
   - `예` 버튼을 클릭합니다
5. 검은 화면에 글자들이 나타나며 설정이 진행됩니다
   - 가만히 기다려주세요 (1~2분)
   - "설정 완료" 메시지가 나타나면 아무 키나 누르세요
6. **바탕화면**에 **"보도자료생성"** 아이콘이 생겼는지 확인합니다

✅ 초기 설정 완료! 이제 이 과정은 다시 하지 않아도 됩니다.

## 📌 매일 사용하기

### 프로그램 시작하기

1. **바탕화면**의 **"보도자료생성"** 아이콘을 **더블클릭**합니다
2. 잠시 기다리면 **웹 브라우저**가 자동으로 열립니다
3. 웹 화면이 나타나면 사용 준비 완료!

### 보도자료 만들기

**방법 A: 기초자료 수집표로 시작하기**
1. **파일 업로드** 버튼을 클릭합니다
2. **기초자료 수집표** 엑셀 파일을 선택합니다
3. **분석표 다운로드** 버튼이 나타나면 클릭하여 저장합니다
4. 다운로드된 분석표를 다시 업로드합니다

**방법 B: 분석표로 바로 시작하기**
1. **파일 업로드** 버튼을 클릭합니다
2. **분석표** 엑셀 파일을 선택합니다
3. 자동으로 보도자료 생성 화면으로 이동합니다

### 프로그램 종료하기

1. 웹 브라우저 창을 닫습니다
2. 검은 화면(명령 프롬프트)의 **X 버튼**을 클릭하여 닫습니다

> ⚠️ 검은 화면을 닫아야 프로그램이 완전히 종료됩니다

---

# 3. 문제 해결 가이드

> 프로그램 사용 중 문제가 발생했을 때 참고하세요.

## 🚫 자주 발생하는 문제와 해결 방법

### 문제 1: "Windows의 PC 보호" 파란 화면

**증상:**
```
Windows의 PC 보호
Windows Defender SmartScreen에서 인식할 수 없는 앱의 
시작을 차단했습니다.
```

**해결 방법:**
1. `추가 정보` 글자를 클릭합니다 (화면 아래쪽)
2. `실행` 버튼을 클릭합니다

> 💡 이 화면은 처음 한 번만 나타납니다.

### 문제 2: "이 앱이 디바이스를 변경할 수 있도록 허용하시겠어요?"

**해결 방법:**
- `예` 버튼을 클릭합니다

### 문제 3: 웹 브라우저가 자동으로 열리지 않음

**해결 방법:**
1. 검은 화면(명령 프롬프트)이 열려 있는지 확인합니다
2. 웹 브라우저(Chrome, Edge 등)를 직접 열고
3. 주소창에 `localhost:5000` 입력
4. Enter 키를 누릅니다

### 문제 4: "초기설정.bat을 먼저 실행해주세요" 메시지

**해결 방법:**
1. `C:\지역경제동향시스템` 폴더를 엽니다
2. `초기설정.bat` 파일을 더블클릭합니다
3. 설정이 완료될 때까지 기다립니다

### 문제 5: 파일 업로드가 안 됨

**확인 사항:**

| 확인할 것 | 해결 방법 |
|----------|----------|
| 파일 형식이 `.xlsx` 또는 `.xls`인가요? | 엑셀 파일만 업로드 가능합니다 |
| 파일이 다른 프로그램에서 열려있나요? | 엑셀에서 파일을 닫고 다시 시도하세요 |
| 파일 이름에 특수문자가 있나요? | 파일 이름을 간단하게 변경해보세요 |

### 문제 6: 화면에 데이터가 비어있음 (0이나 빈칸)

**해결 방법:**
1. 업로드한 엑셀 파일을 직접 열어봅니다
2. 해당 시트에 데이터가 있는지 확인합니다
3. 데이터가 있다면 파일을 한 번 저장하고 다시 업로드합니다

> 💡 엑셀에서 파일을 열고 저장하면 수식이 계산됩니다.

### 문제 7: 검은 화면에 빨간색 글씨가 나옴

**걱정하지 마세요!**

대부분의 빨간색 메시지는 오류가 아닙니다.  
웹 브라우저에서 프로그램이 정상 작동하면 무시해도 됩니다.

**진짜 문제인 경우:**
- 웹 브라우저에서 페이지가 열리지 않음
- "Error" 또는 "오류"라는 단어가 반복해서 나타남

이런 경우 IT 담당자에게 검은 화면의 내용을 캡처해서 보내주세요.

### 문제 8: 프로그램이 갑자기 종료됨

**해결 방법:**
1. 바탕화면의 `보도자료생성` 아이콘을 다시 더블클릭합니다
2. 문제가 반복되면 컴퓨터를 재시작하고 다시 시도합니다

### 문제 9: "프로그램이 이미 실행 중입니다" 메시지

**해결 방법:**
1. 웹 브라우저에서 `localhost:5000` 주소로 접속해봅니다
2. 접속이 안 되면:
   - 모든 검은 화면(명령 프롬프트)을 닫습니다
   - 바탕화면의 `보도자료생성` 아이콘을 다시 클릭합니다

## 📸 화면 캡처하는 방법

IT 담당자에게 문의할 때 화면 캡처가 필요할 수 있습니다.

**방법 1: 전체 화면 캡처**
1. 키보드에서 `PrtSc` 또는 `Print Screen` 키를 누릅니다
2. 그림판을 열고 `Ctrl + V`를 누릅니다
3. 파일로 저장합니다

**방법 2: 현재 창만 캡처**
1. 캡처할 창을 클릭합니다
2. `Alt + PrtSc`를 누릅니다
3. 그림판을 열고 `Ctrl + V`를 누릅니다
4. 파일로 저장합니다

## 📞 IT 담당자에게 문의할 때

다음 정보를 함께 알려주시면 빠른 해결이 가능합니다:

1. ✅ **어떤 화면**에서 문제가 발생했나요?
2. ✅ **어떤 메시지**가 나타났나요? (화면 캡처)
3. ✅ **어떤 파일**을 사용하고 있었나요?
4. ✅ **언제부터** 문제가 발생했나요?

## 🔄 프로그램 재설치 방법

모든 해결 방법이 안 될 경우, 프로그램을 재설치합니다:

1. `C:\지역경제동향시스템` 폴더를 삭제합니다
2. 전달받은 원본 폴더를 다시 `C:\` 에 복사합니다
3. `초기설정.bat`을 실행합니다

> ⚠️ 이 방법은 마지막 수단입니다. IT 담당자와 상의 후 진행하세요.

---

# 4. Windows 배포 이슈

> Windows EXE 배포 시 발생 가능한 문제점과 해결 방안

## 주요 문제점

### 1. `__file__` 경로 문제 (가장 중요)

**문제:**
- `config/settings.py`에서 `BASE_DIR = Path(__file__).parent.parent`로 경로를 설정하고 있음
- PyInstaller나 cx_Freeze로 패키징할 때 `__file__`이 임시 디렉토리를 가리킴
- 리소스 파일(templates, config 등)을 찾지 못하는 문제 발생

**해결 방법:**
- `sys._MEIPASS` 또는 PyInstaller의 `sys.frozen` 체크 필요
- 리소스 파일은 별도 디렉토리에 복사하거나 `--add-data` 옵션으로 포함

### 2. 리소스 파일 접근 불가

**문제:**
- `templates/` 디렉토리의 HTML, JSON, Python 파일들이 EXE에 번들링되어 접근 방식이 달라짐
- 동적 모듈 로드(`importlib.util`)가 실패할 수 있음

**해결 방법:**
- 패키징 시 모든 generator 모듈을 미리 포함
- 또는 정적 임포트 방식으로 변경

### 3. 업로드/출력 폴더 경로 문제

**문제:**
- `UPLOAD_FOLDER`, `DEBUG_FOLDER`, `EXPORT_FOLDER`가 BASE_DIR 기준으로 생성됨
- EXE 패키징 환경에서는 임시 디렉토리를 가리키거나, EXE 종료 시 삭제될 수 있음

**해결 방법:**
- 사용자 문서 폴더나 EXE 실행 파일 위치 기준으로 경로 설정 필요
- 예: `Path.home() / 'Documents' / 'capstone_data'` 또는 `Path(sys.executable).parent / 'data'`

## 권장 해결 방안

### `config/settings.py` 수정

```python
import sys
from pathlib import Path

def get_base_dir():
    """EXE 패키징 환경과 개발 환경을 모두 지원하는 BASE_DIR 반환"""
    if getattr(sys, 'frozen', False):
        # EXE 실행 환경 (PyInstaller)
        if hasattr(sys, '_MEIPASS'):
            return Path(sys.executable).parent
        else:
            return Path(sys.executable).parent
    else:
        # 개발 환경
        return Path(__file__).parent.parent

def get_resource_dir():
    """리소스 파일(templates, config 등)이 있는 디렉토리 반환"""
    if getattr(sys, 'frozen', False) and hasattr(sys, '_MEIPASS'):
        # PyInstaller 실행 환경
        return Path(sys._MEIPASS)
    else:
        # 개발 환경
        return Path(__file__).parent.parent
```

### 작업 체크리스트

리팩토링 시 다음 항목들을 확인하세요:

- [ ] `config/settings.py`에 EXE 환경 감지 로직 추가
- [ ] `get_base_dir()`, `get_resource_dir()` 함수 구현
- [ ] 모든 리소스 파일 경로를 `get_resource_dir()` 기반으로 변경
- [ ] 데이터 폴더 경로를 EXE 위치 또는 사용자 문서 폴더로 변경
- [ ] `.env` 파일 경로 처리 수정
- [ ] Flask `template_folder`, `static_folder` 경로 수정
- [ ] 동적 모듈 로드 테스트
- [ ] 한글 파일명 처리 테스트
- [ ] PyInstaller spec 파일 작성
- [ ] EXE 빌드 및 테스트

---

# 5. 자주 묻는 질문

### Q1: "Windows의 PC 보호" 창이 계속 나타나요

**A:** 초기 설정을 다시 한 번 실행해주세요. 설정이 완료되면 더 이상 나타나지 않습니다.

### Q2: 웹 브라우저가 자동으로 안 열려요

**A:** 다음을 확인해주세요:
1. 검은 화면이 열려 있는지 확인
2. 검은 화면에 "서버 시작" 메시지가 있는지 확인
3. 웹 브라우저를 직접 열고 주소창에 `localhost:5000` 입력

### Q3: "Excel을 찾을 수 없습니다" 메시지가 나와요

**A:** 걱정하지 마세요! 프로그램이 자동으로 다른 방법을 사용합니다. 정상 작동합니다.

### Q4: 파일 업로드가 안 돼요

**A:** 다음을 확인해주세요:
1. 파일이 `.xlsx` 또는 `.xls` 형식인지 확인
2. 파일이 다른 프로그램에서 열려있지 않은지 확인
3. 엑셀에서 파일을 닫고 다시 시도

### Q5: 검은 화면에 빨간 글씨가 나와요

**A:** 대부분의 경우 정상입니다. 웹 브라우저에서 프로그램이 잘 작동하면 무시하셔도 됩니다.

### Q6: 컴퓨터를 재시작했는데 다시 초기 설정해야 하나요?

**A:** 아니요! 바탕화면의 "보도자료생성" 아이콘만 더블클릭하시면 됩니다.

---

## 📝 버전 정보

- **프로그램 버전**: 1.0
- **문서 작성일**: 2026년 1월 1일
- **개발**: 국가데이터처 캡스톤 프로젝트팀

---

*이 문서는 배포 및 설치를 위해 통합되었습니다.*
