# 통계청 보도자료 자동화 시스템 - 프로젝트 구조 브리핑

## 📋 프로젝트 개요

이 시스템은 **엑셀 파일에 저장된 통계 데이터를 자동으로 읽어서, HTML 형식의 보도자료를 자동으로 생성**하는 프로그램입니다.

### 주요 목적
- 엑셀 파일에서 데이터를 자동으로 추출
- 미리 만든 HTML 템플릿(보도자료 양식)에 데이터를 자동으로 채워넣기
- 합계, 평균, 증감률 등 필요한 계산을 자동으로 수행
- 최종적으로 완성된 보도자료 HTML 파일 생성

---

## 🎯 시스템이 하는 일 (전체 흐름)

```
1. 엑셀 파일 업로드
   ↓
2. 엑셀 파일에서 데이터 읽기
   ↓
3. HTML 템플릿(보도자료 양식) 불러오기
   ↓
4. 템플릿에 있는 특수 표시(마커)를 찾아서
   ↓
5. 엑셀 데이터로 자동으로 채워넣기
   ↓
6. 필요한 계산(합계, 증감률 등) 수행
   ↓
7. 완성된 보도자료 HTML 파일 생성
```

---

## 🗂️ 프로젝트 파일 구조

### 📁 주요 폴더 설명

#### 1. **`src/` 폴더** - 시스템의 핵심 기능들
이 폴더에는 보도자료를 만드는 데 필요한 모든 기능들이 들어있습니다.

| 파일명 | 역할 | 설명 |
|--------|------|------|
| `excel_extractor.py` | 엑셀 읽기 담당 | 엑셀 파일을 열고, 시트별로 데이터를 읽어오는 기능 |
| `template_manager.py` | 템플릿 관리 담당 | HTML 템플릿 파일을 불러오고, 어디에 데이터를 넣을지 찾는 기능 |
| `template_filler.py` | 데이터 채우기 담당 | 템플릿의 빈 자리에 엑셀 데이터를 채워넣는 핵심 기능 |
| `calculator.py` | 계산 담당 | 합계, 평균, 증감률, 증감액 등을 계산하는 기능 |
| `data_analyzer.py` | 데이터 분석 담당 | 데이터를 분석하고 해석하는 기능 |
| `config.py` | 설정 관리 | 연도와 분기 정보를 관리하고, 해당하는 엑셀 열을 찾는 기능 |
| `main.py` | 명령줄 실행 | 터미널(명령줄)에서 프로그램을 실행할 때 사용 |

#### 2. **`templates/` 폴더** - 보도자료 양식들
완성된 보도자료의 디자인과 구조가 들어있는 HTML 파일들이 저장된 곳입니다.

| 파일명 | 설명 |
|--------|------|
| `web_interface.html` | 웹 브라우저에서 보이는 화면 디자인 |
| `dynamic_template.html` | 실제 보도자료를 만드는 기본 템플릿 |
| `preview.html` | 생성된 보도자료를 미리 볼 수 있는 화면 |
| `error.html` | 오류가 발생했을 때 보여주는 화면 |

#### 3. **`output/` 폴더** - 생성된 결과물
시스템이 만든 최종 보도자료 HTML 파일들이 저장되는 곳입니다.

#### 4. **`data/` 폴더** - 입력 데이터
처리할 엑셀 파일들을 저장하는 곳입니다.

---

## 💻 사용 방법

### 방법 1: 웹 브라우저 사용 (가장 쉬운 방법) ⭐

1. **웹 서버 실행**
   - `run_web.py` 파일을 실행하면 웹 서버가 시작됩니다
   - 브라우저에서 `http://localhost:8000` 주소로 접속합니다

2. **웹 화면에서 작업**
   - 엑셀 파일 업로드
   - 연도와 분기 선택
   - 템플릿 파일 선택 (또는 기본 템플릿 사용)
   - "보도자료 생성하기" 버튼 클릭

3. **결과 확인**
   - 생성된 보도자료를 미리 볼 수 있습니다
   - 다운로드 버튼을 눌러 HTML 파일로 저장할 수 있습니다

### 방법 2: 명령줄 사용 (고급 사용자용)

터미널(명령줄)에서 직접 명령어를 입력하여 실행하는 방법입니다.

---

## 🔧 시스템의 핵심 구성 요소

### 1. **엑셀 데이터 추출기** (`excel_extractor.py`)
- **역할**: 엑셀 파일을 열고, 각 시트의 셀 값을 읽어옵니다
- **예시**: "광공업생산" 시트의 A1 셀 값이 1234.5라면, 이 값을 가져옵니다

### 2. **템플릿 관리자** (`template_manager.py`)
- **역할**: HTML 템플릿 파일을 읽고, 데이터를 넣을 위치(마커)를 찾습니다
- **마커 예시**: `{광공업생산:A1}` → "광공업생산" 시트의 A1 셀 값을 여기에 넣으라는 표시

### 3. **계산기** (`calculator.py`)
- **역할**: 데이터에 대한 계산을 수행합니다
- **지원하는 계산**:
  - 합계 (sum)
  - 평균 (average)
  - 최대값/최소값
  - 증감률 (전년 대비 몇 % 증가/감소)
  - 증감액 (전년 대비 얼마나 증가/감소)

### 4. **템플릿 채우기** (`template_filler.py`)
- **역할**: 템플릿의 마커를 찾아서 실제 데이터로 바꿔주는 핵심 기능
- **작업 과정**:
  1. 템플릿에서 `{시트명:셀주소}` 같은 마커를 찾습니다
  2. 엑셀 파일에서 해당 데이터를 가져옵니다
  3. 필요하면 계산을 수행합니다
  4. 마커를 실제 값으로 교체합니다
  5. 숫자 포맷팅(천 단위 구분, 퍼센트 표시 등)을 적용합니다

### 5. **설정 관리** (`config.py`)
- **역할**: 연도와 분기 정보를 관리하고, 엑셀 파일의 어느 열을 읽어야 하는지 계산합니다
- **예시**: 2025년 2분기 데이터를 요청하면, 엑셀 파일의 해당 열 번호를 자동으로 계산합니다

---

## 📊 데이터 처리 예시

### 마커 형식

템플릿 파일에서 다음과 같은 형식으로 데이터를 넣을 위치를 표시합니다:

1. **단순 값 삽입**
   ```
   {광공업생산:A1}
   ```
   → "광공업생산" 시트의 A1 셀 값을 그대로 넣습니다

2. **계산식 적용**
   ```
   {광공업생산:A1:A5:sum}
   ```
   → A1부터 A5까지의 합계를 계산해서 넣습니다

   ```
   {광공업생산:A1:A2:증감률}
   ```
   → A1과 A2의 증감률(퍼센트)을 계산해서 넣습니다

### 실제 처리 과정

**엑셀 파일 예시:**
```
시트명: 광공업생산
A1: 1000
A2: 1100
```

**템플릿 예시:**
```html
<p>현재 값: {광공업생산:A1}</p>
<p>전년 값: {광공업생산:A2}</p>
<p>증감률: {광공업생산:A1:A2:증감률}%</p>
```

**결과:**
```html
<p>현재 값: 1,000</p>
<p>전년 값: 1,100</p>
<p>증감률: -9.09%</p>
```

---

## 🎨 웹 인터페이스 구성

### `app.py` - 웹 서버의 핵심

이 파일은 웹 브라우저와 통신하는 서버 프로그램입니다.

**주요 기능:**
- 파일 업로드 받기
- 엑셀 파일의 시트 목록 보여주기
- 보도자료 생성 요청 처리
- 생성된 파일 미리보기 제공
- 파일 다운로드 제공

**주요 페이지:**
- `/` - 메인 화면 (파일 업로드 및 설정)
- `/preview/<파일ID>` - 생성된 보도자료 미리보기
- `/download/<파일ID>` - 보도자료 다운로드

---

## 📦 필요한 프로그램들 (의존성)

시스템이 동작하기 위해 필요한 외부 라이브러리들이 `requirements.txt`에 정리되어 있습니다:

- **pandas**: 엑셀 데이터를 다루기 위한 도구
- **openpyxl**: 엑셀 파일을 읽고 쓰기 위한 도구
- **beautifulsoup4**: HTML 파일을 분석하고 수정하기 위한 도구
- **Flask**: 웹 서버를 만들기 위한 도구
- **Pillow, pytesseract, opencv-python**: 이미지 처리 및 템플릿 생성 기능용

---

## 🔄 전체 시스템 흐름도

```
[사용자]
   ↓
[웹 브라우저] → 엑셀 파일 업로드 + 설정 입력
   ↓
[app.py] → 요청 받기
   ↓
[TemplateManager] → 템플릿 파일 읽기
   ↓
[ExcelExtractor] → 엑셀 파일 읽기
   ↓
[TemplateFiller] → 마커 찾기 + 데이터 채우기
   ↓
[Calculator] → 필요한 계산 수행
   ↓
[TemplateFiller] → 최종 HTML 생성
   ↓
[app.py] → 결과 파일 저장 및 반환
   ↓
[웹 브라우저] → 미리보기 또는 다운로드
   ↓
[사용자] → 완성된 보도자료 확인
```

---

## 💡 핵심 개념 정리

### 마커 (Marker)
- 템플릿 파일에서 데이터를 넣을 위치를 표시하는 특수 표기법
- 형식: `{시트명:셀주소}` 또는 `{시트명:셀범위:계산식}`
- 예: `{광공업생산:A1}`, `{광공업생산:A1:A5:sum}`

### 템플릿 (Template)
- 보도자료의 디자인과 구조가 들어있는 HTML 파일
- 마커가 표시된 빈 자리에 데이터가 자동으로 채워집니다

### 시트 (Sheet)
- 엑셀 파일 내의 각각의 워크시트
- 예: "광공업생산", "지역경제" 등

### 셀 주소 (Cell Address)
- 엑셀에서 셀의 위치를 나타내는 표기법
- 예: A1 (첫 번째 열, 첫 번째 행), B5 (두 번째 열, 다섯 번째 행)

---

## 🎯 사용 시나리오 예시

### 시나리오: 2025년 2분기 지역경제 보도자료 생성

1. **준비물**
   - 엑셀 파일: `기초자료 수집표_2025년 2분기_캡스톤.xlsx`
   - 템플릿 파일: `templates/dynamic_template.html` (또는 직접 만든 템플릿)

2. **작업 과정**
   - 웹 브라우저에서 시스템 접속
   - 엑셀 파일 업로드
   - 연도: 2025, 분기: 2 선택
   - 템플릿 파일 선택 (또는 기본 템플릿 사용)
   - "보도자료 생성하기" 클릭

3. **결과**
   - 시스템이 자동으로:
     - 엑셀 파일에서 2025년 2분기 데이터를 찾아 읽습니다
     - 템플릿의 모든 마커를 찾아 데이터로 채웁니다
     - 필요한 계산(증감률, 합계 등)을 수행합니다
     - 숫자를 보기 좋게 포맷팅합니다 (천 단위 구분, 퍼센트 등)
   - 완성된 HTML 파일이 생성됩니다

4. **확인 및 활용**
   - 미리보기로 결과 확인
   - 다운로드하여 저장
   - 필요시 수정 후 사용

---

## 📝 요약

이 시스템은 **엑셀 데이터를 자동으로 읽어서 HTML 보도자료를 만드는 자동화 도구**입니다.

**주요 장점:**
- ✅ 수작업으로 데이터를 복사-붙여넣기할 필요 없음
- ✅ 계산 실수 방지 (자동 계산)
- ✅ 일관된 포맷으로 보도자료 생성
- ✅ 웹 브라우저에서 쉽게 사용 가능
- ✅ 템플릿만 준비하면 반복 작업이 자동화됨

**핵심 파일:**
- `app.py`: 웹 서버 (사용자 인터페이스)
- `src/template_filler.py`: 데이터 채우기 (핵심 로직)
- `src/excel_extractor.py`: 엑셀 읽기
- `src/calculator.py`: 계산 수행
- `templates/`: 보도자료 양식들

---

*이 문서는 프로그래밍 지식이 없는 통계청 직원을 위해 작성되었습니다.*

