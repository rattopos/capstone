{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "요약-고용인구 스키마",
  "description": "지역경제동향 요약 - 고용/인구 부문 생성을 위한 데이터 스키마",
  
  "type": "object",
  "required": ["report_info", "employment", "population", "page_number"],
  
  "properties": {
    "report_info": {
      "type": "object",
      "description": "보고서 기본 정보",
      "required": ["year", "quarter"],
      "properties": {
        "year": {
          "type": "integer",
          "description": "보고서 기준 연도",
          "example": 2025
        },
        "quarter": {
          "type": "integer",
          "description": "보고서 기준 분기",
          "enum": [1, 2, 3, 4],
          "example": 2
        }
      }
    },
    
    "employment": {
      "type": "object",
      "description": "고용률 데이터",
      "required": ["nationwide", "increase_regions", "decrease_regions", "increase_count", "decrease_count", "chart_data"],
      "properties": {
        "nationwide": {
          "type": "object",
          "description": "전국 데이터",
          "required": ["rate", "change"],
          "properties": {
            "rate": {
              "type": "number",
              "description": "고용률 (%)",
              "example": 63.5
            },
            "change": {
              "type": "number",
              "description": "전년동분기대비 증감 (%p)",
              "example": 0.2
            }
          }
        },
        "increase_regions": {
          "type": "array",
          "description": "상승 지역 (상승폭 높은 순)",
          "items": {
            "$ref": "#/definitions/region_data"
          }
        },
        "decrease_regions": {
          "type": "array",
          "description": "하락 지역 (하락폭 높은 순, 절대값 기준)",
          "items": {
            "$ref": "#/definitions/region_data"
          }
        },
        "increase_count": {
          "type": "integer",
          "description": "상승 지역 수",
          "example": 11
        },
        "decrease_count": {
          "type": "integer",
          "description": "하락 지역 수",
          "example": 4
        },
        "chart_data": {
          "type": "array",
          "description": "차트용 시도별 데이터 (순서대로)",
          "items": {
            "$ref": "#/definitions/employment_chart_data"
          }
        }
      }
    },
    
    "population": {
      "type": "object",
      "description": "인구이동 데이터",
      "required": ["inflow_regions", "outflow_regions", "inflow_count", "outflow_count", "chart_data"],
      "properties": {
        "inflow_regions": {
          "type": "array",
          "description": "순유입 지역 (유입량 높은 순)",
          "items": {
            "$ref": "#/definitions/population_region_data"
          }
        },
        "outflow_regions": {
          "type": "array",
          "description": "순유출 지역 (유출량 높은 순, 절대값 기준)",
          "items": {
            "$ref": "#/definitions/population_region_data"
          }
        },
        "inflow_count": {
          "type": "integer",
          "description": "순유입 지역 수",
          "example": 7
        },
        "outflow_count": {
          "type": "integer",
          "description": "순유출 지역 수",
          "example": 10
        },
        "chart_data": {
          "type": "array",
          "description": "차트용 시도별 데이터 (순서대로)",
          "items": {
            "$ref": "#/definitions/population_chart_data"
          }
        }
      }
    },
    
    "page_number": {
      "type": "integer",
      "description": "페이지 번호",
      "example": 5
    }
  },
  
  "definitions": {
    "region_data": {
      "type": "object",
      "required": ["name", "value"],
      "properties": {
        "name": {
          "type": "string",
          "description": "지역명",
          "example": "전북"
        },
        "value": {
          "type": "number",
          "description": "증감 (%p)",
          "example": -1.0
        }
      }
    },
    "population_region_data": {
      "type": "object",
      "required": ["name", "value"],
      "properties": {
        "name": {
          "type": "string",
          "description": "지역명",
          "example": "경기"
        },
        "value": {
          "type": "integer",
          "description": "순이동 인구수 (명)",
          "example": 10426
        }
      }
    },
    "employment_chart_data": {
      "type": "object",
      "required": ["name", "rate", "change"],
      "properties": {
        "name": {
          "type": "string",
          "description": "지역명 (약어)",
          "example": "전국"
        },
        "rate": {
          "type": "number",
          "description": "고용률 (%)",
          "example": 63.5
        },
        "change": {
          "type": "number",
          "description": "전년동분기대비 증감 (%p)",
          "example": 0.2
        },
        "group": {
          "type": "string",
          "description": "지역 그룹명 (선택, 첫 번째 지역에만 표시)",
          "example": "경인"
        }
      }
    },
    "population_chart_data": {
      "type": "object",
      "required": ["name", "value"],
      "properties": {
        "name": {
          "type": "string",
          "description": "지역명 (약어)",
          "example": "서울"
        },
        "value": {
          "type": "number",
          "description": "순이동 인구수 (명)",
          "example": -10051
        },
        "value_normalized": {
          "type": "number",
          "description": "차트 높이 정규화 값 (-100 ~ 100)",
          "example": -100
        },
        "group": {
          "type": "string",
          "description": "지역 그룹명 (선택, 첫 번째 지역에만 표시)",
          "example": "경인"
        }
      }
    }
  },
  
  "data_sources": {
    "description": "데이터 소스 매핑",
    "employment": {
      "source": "고용률_data.json",
      "fields": {
        "nationwide.rate": "nationwide_data.employment_rate",
        "nationwide.change": "nationwide_data.change",
        "increase_regions": "regional_data.increase_regions",
        "decrease_regions": "regional_data.decrease_regions"
      }
    },
    "population": {
      "source": "국내인구이동_data.json",
      "fields": {
        "inflow_regions": "inflow_regions",
        "outflow_regions": "outflow_regions"
      }
    }
  },
  
  "example": {
    "report_info": {
      "year": 2025,
      "quarter": 2
    },
    "employment": {
      "nationwide": {
        "rate": 63.5,
        "change": 0.2
      },
      "increase_regions": [
        {"name": "대전", "value": 1.2},
        {"name": "부산", "value": 1.0},
        {"name": "강원", "value": 1.0}
      ],
      "decrease_regions": [
        {"name": "전북", "value": -1.0},
        {"name": "광주", "value": -0.4},
        {"name": "서울", "value": -0.2}
      ],
      "increase_count": 11,
      "decrease_count": 4,
      "chart_data": [
        {"name": "전국", "rate": 63.5, "change": 0.2},
        {"name": "서울", "rate": 61.8, "change": -0.2, "group": "경인"},
        {"name": "인천", "rate": 63.8, "change": 0.4},
        {"name": "경기", "rate": 64.7, "change": 0.1}
      ]
    },
    "population": {
      "inflow_regions": [
        {"name": "경기", "value": 10426},
        {"name": "인천", "value": 8050},
        {"name": "충남", "value": 2132}
      ],
      "outflow_regions": [
        {"name": "서울", "value": -10051},
        {"name": "부산", "value": -3704},
        {"name": "광주", "value": -2854}
      ],
      "inflow_count": 7,
      "outflow_count": 10,
      "chart_data": [
        {"name": "서울", "value": -10051, "value_normalized": -100, "group": "경인"},
        {"name": "인천", "value": 8050, "value_normalized": 80},
        {"name": "경기", "value": 10426, "value_normalized": 100}
      ]
    },
    "page_number": 5
  }
}

