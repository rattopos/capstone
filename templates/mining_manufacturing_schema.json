{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "광공업생산 보도자료 스키마",
  "description": "광공업생산 통계 보도자료 생성을 위한 데이터 스키마",
  
  "definitions": {
    "industry_name_mapping": {
      "description": "엑셀 데이터의 업종명과 보도자료 표기명 매핑",
      "type": "object",
      "properties": {
        "반도체·전자부품": ["전자 부품, 컴퓨터, 영상, 음향 및 통신장비 제조업", "반도체 제조업", "전자 부품 제조업"],
        "의료·정밀": ["의료, 정밀, 광학 기기 및 시계 제조업"],
        "의약품": ["의료용 물질 및 의약품 제조업"],
        "기타 운송장비": ["기타 운송장비 제조업"],
        "기타기계장비": ["기타 기계 및 장비 제조업"],
        "전기장비": ["전기장비 제조업"],
        "자동차·트레일러": ["자동차 및 트레일러 제조업"],
        "전기·가스업": ["전기, 가스, 증기 및 공기 조절 공급업", "전기업 및 가스업"],
        "식료품": ["식료품 제조업"],
        "금속가공": ["금속 가공제품 제조업; 기계 및 가구 제외"],
        "1차금속": ["1차 금속 제조업"],
        "화학물질": ["화학 물질 및 화학제품 제조업; 의약품 제외"],
        "담배": ["담배 제조업"],
        "고무·플라스틱": ["고무 및 플라스틱제품 제조업"],
        "비금속광물": ["비금속 광물제품 제조업"],
        "섬유제품": ["섬유제품 제조업; 의복 제외"],
        "금속광업": ["금속 광업"],
        "금속가공제품": ["금속 가공제품 제조업; 기계 및 가구 제외"],
        "산업용기계": ["산업용 기계 및 장비 수리업"]
      }
    },
    
    "region_mapping": {
      "description": "엑셀 데이터의 지역명과 보도자료 표기명 매핑",
      "type": "object",
      "properties": {
        "서울": "서울",
        "부산": "부산",
        "대구": "대구",
        "인천": "인천",
        "광주": "광주",
        "대전": "대전",
        "울산": "울산",
        "세종": "세종",
        "경기": "경기",
        "강원": "강원",
        "충북": "충북",
        "충남": "충남",
        "전북": "전북",
        "전남": "전남",
        "경북": "경북",
        "경남": "경남",
        "제주": "제주"
      }
    }
  },
  
  "type": "object",
  "required": ["report_info", "nationwide_data", "regional_data", "summary_table"],
  
  "properties": {
    "report_info": {
      "type": "object",
      "description": "보도자료 기본 정보",
      "required": ["year", "quarter", "data_source"],
      "properties": {
        "year": {
          "type": "integer",
          "description": "보도자료 기준 연도",
          "example": 2025
        },
        "quarter": {
          "type": "integer",
          "description": "보도자료 기준 분기",
          "enum": [1, 2, 3, 4],
          "example": 2
        },
        "data_source": {
          "type": "string",
          "description": "데이터 출처",
          "default": "국가데이터 국가통계포털(KOSIS), 광업제조업동향조사"
        }
      }
    },
    
    "nationwide_data": {
      "type": "object",
      "description": "전국 광공업생산 데이터",
      "required": ["production_index", "growth_rate", "growth_direction", "main_increase_industries", "main_decrease_industries"],
      "properties": {
        "production_index": {
          "type": "number",
          "description": "광공업생산지수 (2020=100)",
          "example": 114.4
        },
        "growth_rate": {
          "type": "number",
          "description": "전년동분기대비 증감률 (%)",
          "example": 2.1
        },
        "growth_direction": {
          "type": "string",
          "description": "증감 방향",
          "enum": ["증가", "감소"],
          "example": "증가"
        },
        "main_increase_industries": {
          "type": "array",
          "description": "주요 증가 기여 업종 (기여도 순)",
          "items": {
            "type": "object",
            "properties": {
              "name": {"type": "string", "description": "업종명 (보도자료 표기명)"},
              "contribution": {"type": "number", "description": "기여도"}
            }
          },
          "example": [
            {"name": "반도체·전자부품", "contribution": 1.833},
            {"name": "기타 운송장비", "contribution": 0.600}
          ]
        },
        "main_decrease_industries": {
          "type": "array",
          "description": "주요 감소 기여 업종 (기여도 절대값 순)",
          "items": {
            "type": "object",
            "properties": {
              "name": {"type": "string"},
              "contribution": {"type": "number"}
            }
          }
        }
      }
    },
    
    "regional_data": {
      "type": "object",
      "description": "시도별 광공업생산 데이터",
      "required": ["increase_regions", "decrease_regions", "region_count"],
      "properties": {
        "increase_regions": {
          "type": "array",
          "description": "증가 지역 (증가율 높은 순)",
          "items": {
            "$ref": "#/definitions/region_data"
          }
        },
        "decrease_regions": {
          "type": "array",
          "description": "감소 지역 (감소율 높은 순, 절대값 기준)",
          "items": {
            "$ref": "#/definitions/region_data"
          }
        },
        "region_count": {
          "type": "integer",
          "description": "증가 지역 수",
          "example": 10
        }
      }
    },
    
    "summary_box": {
      "type": "object",
      "description": "회색 박스 요약 정보 (주요 증감 지역 및 업종 요약)",
      "properties": {
        "main_increase_regions": {
          "type": "array",
          "description": "주요 증가 지역들 (증가율 높은 순)",
          "items": {
            "type": "object",
            "properties": {
              "region": {"type": "string"},
              "industries": {"type": "array", "items": {"type": "string"}}
            }
          }
        },
        "region_count": {
          "type": "integer",
          "description": "전체 증가 지역 수"
        }
      }
    },
    
    "top3_increase_regions": {
      "type": "array",
      "description": "증가율 상위 3개 시도 (< 주요 증감 지역 및 업종 > 섹션용)",
      "items": {
        "$ref": "#/definitions/region_industry_detail"
      },
      "minItems": 3,
      "maxItems": 3
    },
    
    "top3_decrease_regions": {
      "type": "array", 
      "description": "감소율 상위 3개 시도 (절대값 기준, < 주요 증감 지역 및 업종 > 섹션용)",
      "items": {
        "$ref": "#/definitions/region_industry_detail"
      },
      "minItems": 3,
      "maxItems": 3
    },
    
    "summary_table": {
      "type": "object",
      "description": "하단 광공업생산지수 및 증감률 표",
      "properties": {
        "title": {
          "type": "string",
          "default": "《 광공업생산지수 및 증감률》"
        },
        "base_year": {
          "type": "integer",
          "description": "기준년도 (지수 100 기준)",
          "default": 2020
        },
        "columns": {
          "type": "object",
          "properties": {
            "growth_rate_columns": {
              "type": "array",
              "description": "전년동분기대비 증감률(%) 컬럼들",
              "items": {"type": "string"},
              "example": ["2023.2/4", "2024.2/4", "2025.1/4", "2025.2/4p"]
            },
            "index_columns": {
              "type": "array",
              "description": "광공업생산지수 컬럼들",
              "items": {"type": "string"},
              "example": ["2024.2/4", "2025.2/4p"]
            }
          }
        },
        "regions": {
          "type": "array",
          "description": "표에 표시할 지역들 (순서대로)",
          "items": {
            "type": "object",
            "properties": {
              "group": {"type": "string", "description": "지역 그룹명 (예: 충청)"},
              "region": {"type": "string", "description": "지역명"},
              "growth_rates": {"type": "array", "items": {"type": "number"}},
              "indices": {"type": "array", "items": {"type": "number"}}
            }
          }
        }
      }
    }
  },
  
  "definitions": {
    "region_data": {
      "type": "object",
      "required": ["region", "growth_rate", "top_industries"],
      "properties": {
        "region": {
          "type": "string",
          "description": "지역명"
        },
        "growth_rate": {
          "type": "number",
          "description": "전년동분기대비 증감률 (%)"
        },
        "production_index": {
          "type": "number",
          "description": "광공업생산지수"
        },
        "top_industries": {
          "type": "array",
          "description": "기여도 상위 3개 업종",
          "items": {
            "type": "object",
            "properties": {
              "name": {"type": "string", "description": "업종명 (보도자료 표기명)"},
              "growth_rate": {"type": "number", "description": "업종 증감률 (%)"},
              "contribution": {"type": "number", "description": "기여도"}
            }
          },
          "minItems": 3,
          "maxItems": 3
        }
      }
    },
    
    "region_industry_detail": {
      "type": "object",
      "description": "지역별 상세 업종 정보 (주요 증감 지역 및 업종 섹션)",
      "properties": {
        "region": {"type": "string"},
        "growth_rate": {"type": "number"},
        "industries": {
          "type": "array",
          "description": "기여도 순 상위 3개 업종",
          "items": {
            "type": "object",
            "properties": {
              "name": {"type": "string"},
              "growth_rate": {"type": "number"}
            }
          }
        }
      }
    }
  },
  
  "excel_column_mapping": {
    "description": "엑셀 'A 분석' 시트의 컬럼 인덱스 매핑",
    "columns": {
      "참고용": 0,
      "조회용": 1,
      "지역코드": 2,
      "지역이름": 3,
      "분류단계": 4,
      "중분류순위": 5,
      "산업코드": 6,
      "산업이름": 7,
      "가중치": 8,
      "2021": 9,
      "2022": 10,
      "2023": 11,
      "2024": 12,
      "2023_2Q": 13,
      "2023_3Q": 14,
      "2023_4Q": 15,
      "2024_1Q": 16,
      "2024_2Q": 17,
      "2024_3Q": 18,
      "2024_4Q": 19,
      "2025_1Q": 20,
      "2025_2Q": 21,
      "증감": 22,
      "증감X가중치": 23,
      "대분류": 24,
      "중분류": 25,
      "기여율": 26,
      "검증": 27,
      "기여도": 28,
      "순위": 29
    }
  },
  
  "excel_aggregation_mapping": {
    "description": "엑셀 'A(광공업생산)집계' 시트의 컬럼 인덱스 매핑 (광공업생산지수 값용)",
    "columns": {
      "조회용": 0,
      "지역코드": 3,
      "지역이름": 4,
      "분류단계": 5,
      "가중치": 6,
      "산업코드": 7,
      "산업이름": 8,
      "2020": 9,
      "2021": 10,
      "2022": 11,
      "2023": 12,
      "2024": 13,
      "2024_2Q": 22,
      "2024_3Q": 23,
      "2024_4Q": 24,
      "2025_1Q": 25,
      "2025_2Q": 26
    }
  },
  
  "rules": {
    "text_generation": {
      "description": "텍스트 생성 규칙",
      
      "nationwide_text_rules": {
        "description": "전국 데이터 텍스트 생성 규칙",
        "increase_pattern": {
          "first_paragraph": "전국 광공업생산({production_index})은 {main_increase_industries} 등의 생산이 늘어 전년동분기대비 {growth_rate}% 증가",
          "contrast_pattern": "줄어 감소하였으나",
          "follow_pattern": "늘어 증가"
        },
        "decrease_pattern": {
          "first_paragraph": "전국 광공업생산({production_index})은 {main_decrease_industries} 등의 생산이 줄어 전년동분기대비 {growth_rate}% 감소",
          "contrast_pattern": "늘어 증가하였으나",
          "follow_pattern": "줄어 감소"
        }
      },
      
      "regional_text_rules": {
        "description": "시도 데이터 텍스트 생성 규칙 (감소 3개 → 증가 3개 순서)",
        "decrease_section": {
          "header": "{region}({growth_rate}%)",
          "industries": "{industry1}, {industry2}, {industry3}",
          "suffix": "등의 생산이 줄어 감소하였으나",
          "region_count": 3,
          "order": "감소율 절대값 큰 순"
        },
        "increase_section": {
          "header": "{region}({growth_rate}%)",
          "industries": "{industry1}, {industry2}, {industry3}",
          "suffix": "등의 생산이 늘어 증가",
          "region_count": 3,
          "order": "증가율 큰 순"
        }
      }
    },
    
    "summary_box_rules": {
      "description": "회색 박스(요약) 생성 규칙",
      "format": "◆광공업생산은 {top_regions_summary} 등 {region_count}개 시도에서 전년동분기대비 증가",
      "top_regions_format": "{region}({industries})",
      "industry_delimiter": ", "
    },
    
    "industry_contribution_section_rules": {
      "description": "< 주요 증감 지역 및 업종 > 섹션 규칙",
      "increase_section": {
        "title": "· 전 국( {growth_rate}%):",
        "format": "{industry}({growth_rate}%)"
      },
      "top3_increase": {
        "format": "· {region}( {growth_rate}%): {industry1}({rate1}%), {industry2}({rate2}%), {industry3}({rate3}%)"
      },
      "top3_decrease": {
        "format": "· {region}({growth_rate}%): {industry1}({rate1}%), {industry2}({rate2}%), {industry3}({rate3}%)"
      }
    },
    
    "number_formatting": {
      "growth_rate": {
        "decimals": 1,
        "positive_prefix": "",
        "negative_prefix": "-"
      },
      "production_index": {
        "decimals": 1
      },
      "contribution": {
        "decimals": 1
      }
    }
  }
}

