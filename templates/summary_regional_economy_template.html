<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% if report_info.year is defined and report_info.quarter is defined and report_info.year and report_info.quarter %}{{ report_info.year }}년 {{ report_info.quarter }}분기{% else %}[연도/분기 입력 필요]{% endif %} 지역경제동향[요약]</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Malgun Gothic", serif;
            font-size: 14pt;
            line-height: 1.6;
            color: #000;
            background: #fff;
        }

        /* 그래프/차트 요소 제거 */
        .chart-container,
        .chart-wrapper,
        .chart-area,
        .graph-container,
        .chart-canvas-wrapper,
        .chart-title,
        canvas,
        svg {
            display: none !important;
        }

        .summary-container {
            width: 210mm;
            min-height: 297mm;
            margin: 0 auto;
            padding: 26px 40px;
        }

        .summary-title-wrap {
            display: flex;
            justify-content: center;
            margin-bottom: 16px;
        }

        .summary-title-banner {
            position: relative;
            padding: 8px 28px;
            border-radius: 22px;
            border: 1px solid #7f8fc5;
            background: linear-gradient(90deg, #cfd9f6 0%, #aebce9 50%, #cfd9f6 100%);
            box-shadow: inset 0 0 0 2px #e7ecfb;
        }

        .summary-title-text {
            font-size: 16pt;
            font-weight: 700;
            color: #000;
        }

        .summary-tag {
            color: #1a50f0;
            font-weight: 700;
        }

        .summary-box {
            border: 1px solid #000;
            padding: 16px 18px;
            margin-bottom: 18px;
        }

        .summary-item {
            margin-bottom: 10px;
            display: flex;
            gap: 8px;
            align-items: flex-start;
        }

        .summary-label {
            font-weight: 700;
        }

        .summary-sub {
            margin-top: 6px;
            margin-left: 18px;
            display: flex;
            gap: 8px;
            align-items: flex-start;
        }

        .highlight { font-weight: 700; }
        .increase { font-weight: 700; color: #c62828; }
        .decrease { font-weight: 700; color: #1565c0; }
        .value-increase { color: #c62828; }
        .value-decrease { color: #1565c0; }
        .note { font-size: 11.5pt; color: #666; margin-left: 4px; }

        .table-title {
            text-align: center;
            font-size: 14pt;
            font-weight: 700;
            margin-bottom: 6px;
        }

        .table-note {
            text-align: right;
            font-size: 12pt;
            color: #666;
            margin-bottom: 6px;
        }

        .summary-table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid #000;
            font-size: 12pt;
        }

        .summary-table th,
        .summary-table td {
            border: 1px solid #000;
            padding: 5px 6px;
        }

        .summary-table th {
            background: #e0e0e0;
            text-align: center;
            font-weight: 600;
        }

        .summary-table .nationwide-row td {
            background: #f8f1e7;
            font-weight: 600;
        }

        .summary-table .group-cell {
            background: #f5f5f5;
            text-align: center;
            font-weight: 500;
        }

        .summary-table .region-cell {
            text-align: center;
            font-weight: 500;
        }

        .summary-table .value-cell {
            text-align: right;
        }
    </style>
</head>
<body>
    <div class="summary-container" style="width: 210mm; min-height: 297mm; margin: 0 auto; padding: 26px 40px; font-family: 'Malgun Gothic', serif; font-size: 14pt; line-height: 1.6; color: #000; background: #fff;">
        <div class="summary-title-wrap" style="display: flex; justify-content: center; margin-bottom: 16px;">
            <div class="summary-title-banner" style="position: relative; padding: 8px 28px; border-radius: 22px; border: 1px solid #7f8fc5; background: linear-gradient(90deg, #cfd9f6 0%, #aebce9 50%, #cfd9f6 100%); box-shadow: inset 0 0 0 2px #e7ecfb;">
                <span style="position: absolute; top: 50%; left: -18px; width: 12px; height: 12px; border-radius: 50%; background: #7c8ec4; transform: translateY(-50%);"></span>
                <span style="position: absolute; top: 50%; right: -18px; width: 12px; height: 12px; border-radius: 50%; background: #7c8ec4; transform: translateY(-50%);"></span>
                <span class="summary-title-text" style="font-size: 16pt; font-weight: 700; color: #000;">
                    {% if report_info.year is defined and report_info.quarter is defined and report_info.year and report_info.quarter %}{{ report_info.year }}년 {{ report_info.quarter }}분기{% else %}[연도/분기 입력 필요]{% endif %} 지역경제동향<span class="summary-tag" style="color: #1a50f0; font-weight: 700;">[요약]</span>
                </span>
            </div>
        </div>

        <div class="summary-box" style="border: 1px solid #000; padding: 16px 18px; margin-bottom: 18px;">
            <div class="summary-item" style="margin-bottom: 10px; display: flex; gap: 8px; align-items: flex-start;">
                <span style="color: #666;">□</span>
                <span>
                    <span class="summary-label" style="font-weight: 700;">생산</span>(광공업)은
                {% for region in summary.production.mining.increase_regions[:2] %}
                    <span class="highlight" style="font-weight: 700;">{{ region.name }}</span>({{ "%.1f"|format(region.value) }}%){% if not loop.last %}, {% endif %}
                {% endfor %} 등 {{ summary.production.mining.increase_count }}개 시도에서 전년동분기대비 <span class="increase" style="font-weight: 700; color: #c62828;">{{ get_terms('manufacturing', 1)[1] }}</span>,
                {% for region in summary.production.mining.decrease_regions[:2] %}
                    <span class="highlight" style="font-weight: 700;">{{ region.name }}</span>({{ "%.1f"|format(region.value) }}%){% if not loop.last %}, {% endif %}
                {% endfor %} 등 {{ summary.production.mining.decrease_count }}개 시도는 <span class="decrease" style="font-weight: 700; color: #1565c0;">{{ get_terms('manufacturing', -1)[1] }}</span><span class="note" style="font-size: 11.5pt; color: #666; margin-left: 4px;">[전국: {{ "%.1f"|format(summary.production.mining.nationwide) }}%]</span>

                    <div class="summary-sub" style="margin-top: 6px; margin-left: 18px; display: flex; gap: 8px; align-items: flex-start;">
                        <span style="color: #666;">ㅇ</span>
                        <span>
                            서비스업은
                            {% for region in summary.production.service.increase_regions[:2] %}
                            <span class="highlight" style="font-weight: 700;">{{ region.name }}</span>({{ "%.1f"|format(region.value) }}%){% if not loop.last %}, {% endif %}
                            {% endfor %} 등 {{ summary.production.service.increase_count }}개 시도에서 전년동분기대비 <span class="increase" style="font-weight: 700; color: #c62828;">{{ get_terms('service', 1)[1] }}</span>,
                            {% for region in summary.production.service.decrease_regions[:2] %}
                            <span class="highlight" style="font-weight: 700;">{{ region.name }}</span>({{ "%.1f"|format(region.value) }}%){% if not loop.last %}, {% endif %}
                            {% endfor %} 등 {{ summary.production.service.decrease_count }}개 시도는 <span class="decrease" style="font-weight: 700; color: #1565c0;">{{ get_terms('service', -1)[1] }}</span><span class="note" style="font-size: 11.5pt; color: #666; margin-left: 4px;">[전국: {{ "%.1f"|format(summary.production.service.nationwide) }}%]</span>
                        </span>
                    </div>
                </span>
            </div>

            <div class="summary-item" style="margin-bottom: 10px; display: flex; gap: 8px; align-items: flex-start;">
                <span style="color: #666;">□</span>
                <span>
                    <span class="summary-label" style="font-weight: 700;">소비</span>(소매판매)는
                {% for region in summary.consumption.increase_regions[:2] %}
                    <span class="highlight" style="font-weight: 700;">{{ region.name }}</span>({{ "%.1f"|format(region.value) }}%){% if not loop.last %}, {% endif %}
                {% endfor %} 등 {{ summary.consumption.increase_count }}개 시도에서 전년동분기대비 <span class="increase" style="font-weight: 700; color: #c62828;">{{ get_terms('consumption', 1)[1] }}</span>,
                {% for region in summary.consumption.decrease_regions[:2] %}
                    <span class="highlight" style="font-weight: 700;">{{ region.name }}</span>({{ "%.1f"|format(region.value) }}%){% if not loop.last %}, {% endif %}
                {% endfor %} 등 {{ summary.consumption.decrease_count }}개 시도는 <span class="decrease" style="font-weight: 700; color: #1565c0;">{{ get_terms('consumption', -1)[1] }}</span><span class="note" style="font-size: 11.5pt; color: #666; margin-left: 4px;">[전국: {{ "%.1f"|format(summary.consumption.nationwide) }}%]</span>
                </span>
            </div>

            <div class="summary-item" style="margin-bottom: 10px; display: flex; gap: 8px; align-items: flex-start;">
                <span style="color: #666;">□</span>
                <span>
                    <span class="summary-label" style="font-weight: 700;">수출</span>(통관기준)은
                {% for region in summary.exports.increase_regions[:2] %}
                    <span class="highlight" style="font-weight: 700;">{{ region.name }}</span>({{ "%.1f"|format(region.value) }}%){% if not loop.last %}, {% endif %}
                {% endfor %} 등 {{ summary.exports.increase_count }}개 시도에서 전년동분기대비 <span class="increase" style="font-weight: 700; color: #c62828;">{{ get_terms('export', 1)[1] }}</span>,
                {% for region in summary.exports.decrease_regions[:2] %}
                    <span class="highlight" style="font-weight: 700;">{{ region.name }}</span>({{ "%.1f"|format(region.value) }}%){% if not loop.last %}, {% endif %}
                {% endfor %} 등 {{ summary.exports.decrease_count }}개 시도는 <span class="decrease" style="font-weight: 700; color: #1565c0;">{{ get_terms('export', -1)[1] }}</span><span class="note" style="font-size: 11.5pt; color: #666; margin-left: 4px;">[전국: {{ "%.1f"|format(summary.exports.nationwide) }}%]</span>
                </span>
            </div>

            <div class="summary-item" style="margin-bottom: 10px; display: flex; gap: 8px; align-items: flex-start;">
                <span style="color: #666;">□</span>
                <span>
                    <span class="summary-label" style="font-weight: 700;">물가</span>(소비자물가)는
                    전국 전년동분기대비 <span class="{% if summary.price.nationwide >= 0 %}increase{% else %}decrease{% endif %}">{{ "%.1f"|format(summary.price.nationwide | abs) }}% {{ get_terms('price', summary.price.nationwide)[1] }}</span>,
                    {{ summary.price.below_phrase }} 소비자물가 상승률이 전국보다 낮았으나, {{ summary.price.above_phrase }} 전국보다 <span class="increase" style="font-weight: 700; color: #c62828;">높음</span>
                </span>
            </div>

            <div class="summary-item" style="margin-bottom: 0; display: flex; gap: 8px; align-items: flex-start;">
                <span style="color: #666;">□</span>
                <span>
                    <span class="summary-label" style="font-weight: 700;">고용</span>(고용률)은
                {% for region in summary.employment.increase_regions[:2] %}
                    <span class="highlight" style="font-weight: 700;">{{ region.name }}</span>({{ "%.1f"|format(region.value) }}%p){% if not loop.last %}, {% endif %}
                {% endfor %} 등 {{ summary.employment.increase_count }}개 시도에서 전년동분기대비 <span class="increase" style="font-weight: 700; color: #c62828;">{{ get_terms('employment', 1)[1] }}</span>,
                {% for region in summary.employment.decrease_regions[:2] %}
                    <span class="highlight" style="font-weight: 700;">{{ region.name }}</span>({{ "%.1f"|format(region.value) }}%p){% if not loop.last %}, {% endif %}
                {% endfor %}등 {{ summary.employment.decrease_count }}개 시도는 <span class="decrease" style="font-weight: 700; color: #1565c0;">{{ get_terms('employment', -1)[1] }}</span><span class="note" style="font-size: 11.5pt; color: #666; margin-left: 4px;">[전국: {{ "%.1f"|format(summary.employment.nationwide) }}%p]</span>
                </span>
            </div>
        </div>

        <div>
            <div class="table-title">
                &lt;{% if report_info.year is defined and report_info.quarter is defined and report_info.year and report_info.quarter %}{{ report_info.year }}년 {{ report_info.quarter }}분기{% else %}[연도/분기 입력 필요]{% endif %} 주요 지역경제 지표&gt;
            </div>
            <div class="table-note">(전년동분기비, %)</div>

            <table class="summary-table">
                <thead>
                    <tr>
                        <th colspan="2">구분</th>
                        <th style="width: 70px;">광공업생산</th>
                        <th style="width: 70px;">서비스업생산</th>
                        <th style="width: 70px;">소매판매</th>
                        <th style="width: 70px;">수출</th>
                        <th style="width: 70px;">소비자물가</th>
                        <th style="width: 70px;">고용률(%p)</th>
                    </tr>
                </thead>
                <tbody>
                {% set data_rows = table_df if table_df is defined else (table_data.region_rows if table_data is defined and table_data.region_rows is defined else []) %}
                {% set nationwide_row = (data_rows | selectattr('region_name', 'equalto', '전국') | list | first) %}
                <tr class="nationwide-row">
                    <td colspan="2" style="text-align: center;">전 국</td>
                    <td class="value-cell">{{ "%.1f"|format(nationwide_row.mining_production if nationwide_row and nationwide_row.mining_production is defined else 0) }}</td>
                    <td class="value-cell">{{ "%.1f"|format(nationwide_row.service_production if nationwide_row and nationwide_row.service_production is defined else 0) }}</td>
                    <td class="value-cell">{{ "%.1f"|format(nationwide_row.retail_sales if nationwide_row and nationwide_row.retail_sales is defined else 0) }}</td>
                    <td class="value-cell">{{ "%.1f"|format(nationwide_row.exports if nationwide_row and nationwide_row.exports is defined else 0) }}</td>
                    <td class="value-cell">{{ "%.1f"|format(nationwide_row.price if nationwide_row and nationwide_row.price is defined else 0) }}</td>
                    <td class="value-cell">{{ "%.1f"|format(nationwide_row.employment if nationwide_row and nationwide_row.employment is defined else 0) }}</td>
                </tr>

                {% set region_groups = [
                    {'name': '경인', 'regions': ['서울', '인천', '경기']},
                    {'name': '충청', 'regions': ['대전', '세종', '충북', '충남']},
                    {'name': '호남', 'regions': ['광주', '전북', '전남', '제주']},
                    {'name': '동북', 'regions': ['대구', '경북', '강원']},
                    {'name': '동남', 'regions': ['부산', '울산', '경남']}
                ] %}
                {% for group in region_groups %}
                    {% for region_name in group.regions %}
                        {% set row = (data_rows | selectattr('region_name', 'equalto', region_name) | list | first) %}
                        <tr>
                            {% if loop.first %}
                            <td rowspan="{{ group.regions|length }}" class="group-cell" style="width: 40px;">{{ group.name }}</td>
                            {% endif %}
                            <td class="region-cell" style="width: 50px;">{{ row.region_display if row and row.region_display is defined and row.region_display else region_name }}</td>
                            <td class="value-cell {% if row and row.mining_production >= 0 %}value-increase{% else %}value-decrease{% endif %}">{{ "%.1f"|format(row.mining_production if row and row.mining_production is defined else 0) }}</td>
                            <td class="value-cell {% if row and row.service_production >= 0 %}value-increase{% else %}value-decrease{% endif %}">{{ "%.1f"|format(row.service_production if row and row.service_production is defined else 0) }}</td>
                            <td class="value-cell {% if row and row.retail_sales >= 0 %}value-increase{% else %}value-decrease{% endif %}">{{ "%.1f"|format(row.retail_sales if row and row.retail_sales is defined else 0) }}</td>
                            <td class="value-cell {% if row and row.exports >= 0 %}value-increase{% else %}value-decrease{% endif %}">{{ "%.1f"|format(row.exports if row and row.exports is defined else 0) }}</td>
                            <td class="value-cell">{{ "%.1f"|format(row.price if row and row.price is defined else 0) }}</td>
                            <td class="value-cell {% if row and row.employment >= 0 %}value-increase{% else %}value-decrease{% endif %}">{{ "%.1f"|format(row.employment if row and row.employment is defined else 0) }}</td>
                        </tr>
                    {% endfor %}
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</body>
</html>
