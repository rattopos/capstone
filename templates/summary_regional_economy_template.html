<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% if report_info.year is defined and report_info.quarter is defined and report_info.year and
        report_info.quarter %}{{ report_info.year }}년 {{ report_info.quarter }}분기{% else %}[연도/분기 입력 필요]{% endif %}
        지역경제동향[요약]</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "바탕", "Batang", "BatangChe", serif;
            font-size: 12pt;
            line-height: 1.8;
            color: #000;
            background: #fff;
        }

        /* 그래프/차트 요소 제거 */
        .chart-container,
        .chart-wrapper,
        canvas,
        svg {
            display: none !important;
        }

        .summary-container {
            width: 210mm;
            margin: 0 auto;
            padding: 26px 40px 6px 40px;
        }

        /* Section Title Style */
        .section-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 6px 0 18px;
        }

        .section-title span:first-child {
            background: #d9d9d9;
            color: #000;
            font-size: 15pt;
            font-weight: 700;
            padding: 4px 14px;
            border-radius: 2px;
        }

        /* Summary Box */
        .summary-box {
            margin-bottom: 30px;
        }

        /* Summary Item - 주요 항목 */
        .summary-item {
            margin-bottom: 14px;
            display: table;
            width: 100%;
        }

        .summary-bullet {
            display: table-cell;
            width: 18px;
            vertical-align: top;
            font-weight: 400;
            color: #000;
            padding-top: 1px;
        }

        .summary-content {
            display: table-cell;
            vertical-align: top;
            text-align: justify;
            word-break: keep-all;
        }

        /* Label Style - 고용, 생산, 소비 등 */
        .summary-label-clean {
            font-weight: 700;
            font-size: 12pt;
        }

        /* Sub Item - 서비스업 등 하위 항목 */
        .summary-sub {
            margin-top: 8px;
            padding-left: 24px;
            display: table;
            width: calc(100% - 24px);
        }

        .summary-sub .summary-bullet {
            width: 20px;
        }

        .summary-sub .summary-content {
            text-align: justify;
        }

        /* Text Styles */
        .highlight {
            font-weight: 700;
        }

        .increase {
            font-weight: 700;
            color: #c62828;
        }

        .decrease {
            font-weight: 700;
            color: #1565c0;
        }

        .note {
            font-size: 10.5pt;
            color: #555;
        }

        /* Table Styles */
        .table-title {
            text-align: center;
            font-size: 13pt;
            font-weight: 700;
            margin-bottom: 6px;
        }

        .table-note {
            text-align: right;
            font-size: 10pt;
            color: #666;
            margin-bottom: 4px;
        }

        .summary-table {
            width: 100%;
            border-collapse: collapse;
            border-top: 2px solid #000;
            border-bottom: 2px solid #000;
            font-size: 10.5pt;
        }

        .summary-table th,
        .summary-table td {
            border: 1px solid #ccc;
            padding: 5px 4px;
        }

        .summary-table th {
            background: #f5f5f5;
            text-align: center;
            font-weight: 600;
            border-bottom: 1px solid #000;
        }

        .summary-table .nationwide-row td {
            background-color: #fffde7;
            font-weight: 700;
        }

        .summary-table .group-cell {
            background-color: #f9f9f9;
            text-align: center;
            font-weight: 600;
        }

        .summary-table .region-cell {
            text-align: center;
        }

        .summary-table .value-cell {
            text-align: right;
            padding-right: 8px;
        }

        .value-increase {
            color: #c62828;
        }

        .value-decrease {
            color: #1565c0;
        }

        @media print {
            .summary-title-box {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            .summary-table th {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
        }
    </style>
</head>

<body>
    <div class="summary-container">
        <!-- Gray Header Title - 생산 섹션과 동일한 스타일 -->
        <div class="section-title" style="display: flex; align-items: center; gap: 10px; margin: 6px 0 12px;">
            <span style="background: #d9d9d9; color: #000; font-size: 15pt; font-weight: 700; padding: 4px 14px; border-radius: 2px;">{% if report_info.year is defined and report_info.quarter is defined and report_info.year and report_info.quarter %}{{ report_info.year }}년 {{ report_info.quarter }}분기{% else %}[연도/분기 입력 필요]{% endif %} 지역경제동향[요약]</span>
            <span style="flex: 1; height: 1px; background: #8f8f8f;"></span>
        </div>

        <!-- Summary Items List -->
        <div class="summary-box">
            <!-- 1. 고용 -->
            <div class="summary-item">
                <div class="summary-bullet">□</div>
                <div class="summary-content">
                    <span class="summary-label-clean">고용</span><span class="note"> (고용률)</span>은 {% for region in summary.employment.increase_regions[:2] %}<span class="highlight">{{ region.name }}</span>({{ "%.1f"|format(region.value) }}%p){% if not loop.last %}, {% endif %}{% endfor %} 등 {{ summary.employment.increase_count }}개 시도에서 전년동분기대비 <span class="increase">{{ get_terms('employment', 1)[1] }}</span>, {% for region in summary.employment.decrease_regions[:2] %}<span class="highlight">{{ region.name }}</span>({{ "%.1f"|format(region.value) }}%p){% if not loop.last %}, {% endif %}{% endfor %} 등 {{ summary.employment.decrease_count }}개 시도는 <span class="decrease">{{ get_terms('employment', -1)[1] }}</span> <span class="note">[전국: {{ "%.1f"|format(summary.employment.nationwide) }}%p]</span>
                </div>
            </div>

            <!-- 2. 생산 (광공업 + 서비스업) -->
            <div class="summary-item">
                <div class="summary-bullet">□</div>
                <div class="summary-content">
                    <span class="summary-label-clean">생산</span><span class="note"> (광공업)</span>은 {% for region in summary.production.mining.increase_regions[:2] %}<span class="highlight">{{ region.name }}</span>({{ "%.1f"|format(region.value) }}%){% if not loop.last %}, {% endif %}{% endfor %} 등 {{ summary.production.mining.increase_count }}개 시도에서 전년동분기대비 <span class="increase">{{ get_terms('manufacturing', 1)[1] }}</span>, {% for region in summary.production.mining.decrease_regions[:2] %}<span class="highlight">{{ region.name }}</span>({{ "%.1f"|format(region.value) }}%){% if not loop.last %}, {% endif %}{% endfor %} 등 {{ summary.production.mining.decrease_count }}개 시도는 <span class="decrease">{{ get_terms('manufacturing', -1)[1] }}</span> <span class="note">[전국: {{ "%.1f"|format(summary.production.mining.nationwide) }}%]</span>
                    <div class="summary-sub">
                        <div class="summary-bullet">ㅇ</div>
                        <div class="summary-content">
                            <span class="note">(서비스업)</span>은 {% for region in summary.production.service.increase_regions[:2] %}<span class="highlight">{{ region.name }}</span>({{ "%.1f"|format(region.value) }}%){% if not loop.last %}, {% endif %}{% endfor %} 등 {{ summary.production.service.increase_count }}개 시도에서 전년동분기대비 <span class="increase">{{ get_terms('service', 1)[1] }}</span>, {% for region in summary.production.service.decrease_regions[:2] %}<span class="highlight">{{ region.name }}</span>({{ "%.1f"|format(region.value) }}%){% if not loop.last %}, {% endif %}{% endfor %} 등 {{ summary.production.service.decrease_count }}개 시도는 <span class="decrease">{{ get_terms('service', -1)[1] }}</span> <span class="note">[전국: {{ "%.1f"|format(summary.production.service.nationwide) }}%]</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 3. 소비 -->
            <div class="summary-item">
                <div class="summary-bullet">□</div>
                <div class="summary-content">
                    <span class="summary-label-clean">소비</span><span class="note"> (소매판매)</span>는 {% for region in summary.consumption.increase_regions[:2] %}<span class="highlight">{{ region.name }}</span>({{ "%.1f"|format(region.value) }}%){% if not loop.last %}, {% endif %}{% endfor %} 등 {{ summary.consumption.increase_count }}개 시도에서 전년동분기대비 <span class="increase">{{ get_terms('consumption', 1)[1] }}</span>, {% for region in summary.consumption.decrease_regions[:2] %}<span class="highlight">{{ region.name }}</span>({{ "%.1f"|format(region.value) }}%){% if not loop.last %}, {% endif %}{% endfor %} 등 {{ summary.consumption.decrease_count }}개 시도는 <span class="decrease">{{ get_terms('consumption', -1)[1] }}</span> <span class="note">[전국: {{ "%.1f"|format(summary.consumption.nationwide) }}%]</span>
                </div>
            </div>

            <!-- 4. 수출 -->
            <div class="summary-item">
                <div class="summary-bullet">□</div>
                <div class="summary-content">
                    <span class="summary-label-clean">수출</span><span class="note"> (통관기준)</span>은 {% for region in summary.exports.increase_regions[:2] %}<span class="highlight">{{ region.name }}</span>({{ "%.1f"|format(region.value) }}%){% if not loop.last %}, {% endif %}{% endfor %} 등 {{ summary.exports.increase_count }}개 시도에서 전년동분기대비 <span class="increase">{{ get_terms('export', 1)[1] }}</span>, {% for region in summary.exports.decrease_regions[:2] %}<span class="highlight">{{ region.name }}</span>({{ "%.1f"|format(region.value) }}%){% if not loop.last %}, {% endif %}{% endfor %} 등 {{ summary.exports.decrease_count }}개 시도는 <span class="decrease">{{ get_terms('export', -1)[1] }}</span> <span class="note">[전국: {{ "%.1f"|format(summary.exports.nationwide) }}%]</span>
                </div>
            </div>

            <!-- 5. 물가 -->
            <div class="summary-item">
                <div class="summary-bullet">□</div>
                <div class="summary-content">
                    <span class="summary-label-clean">물가</span><span class="note"> (소비자물가)</span>는 전국 전년동분기대비 <span class="{% if summary.price.nationwide >= 0 %}increase{% else %}decrease{% endif %}">{{ "%.1f"|format(summary.price.nationwide | abs) }}% {{ get_terms('price', summary.price.nationwide)[1] }}</span>, {{ summary.price.below_phrase }} 소비자물가 상승률이 전국보다 낮았으나, {{ summary.price.above_phrase }} 전국보다 <span class="increase">높음</span>
                </div>
            </div>

        </div>

        <!-- Table Section -->
        <div>
            <div class="table-title">
                &lt;{% if report_info.year is defined and report_info.quarter is defined and report_info.year and
                report_info.quarter %}{{ report_info.year }}년 {{ report_info.quarter }}분기{% else %}[연도/분기 입력 필요]{% endif
                %} 주요 지역경제 지표&gt;
            </div>
            <div class="table-note">(전년동분기비, %)</div>

            <table class="summary-table">
                <thead>
                    <tr>
                        <th colspan="2">구분</th>
                        <th style="width: 70px;">광공업생산</th>
                        <th style="width: 70px;">서비스업생산</th>
                        <th style="width: 70px;">소매판매</th>
                        <th style="width: 70px;">수출</th>
                        <th style="width: 70px;">소비자물가</th>
                        <th style="width: 70px;">고용률(%p)</th>
                    </tr>
                </thead>
                <tbody>
                    {% set data_rows = table_df if table_df is defined else (table_data.region_rows if table_data is
                    defined and table_data.region_rows is defined else []) %}
                    {% set nationwide_row = (data_rows | selectattr('region_name', 'equalto', '전국') | list | first) %}
                    <tr class="nationwide-row">
                        <td colspan="2" style="text-align: center;">전 국</td>
                        <td class="value-cell">{{ "%.1f"|format(nationwide_row.mining_production if nationwide_row and
                            nationwide_row.mining_production is defined else 0) }}</td>
                        <td class="value-cell">{{ "%.1f"|format(nationwide_row.service_production if nationwide_row and
                            nationwide_row.service_production is defined else 0) }}</td>
                        <td class="value-cell">{{ "%.1f"|format(nationwide_row.retail_sales if nationwide_row and
                            nationwide_row.retail_sales is defined else 0) }}</td>
                        <td class="value-cell">{{ "%.1f"|format(nationwide_row.exports if nationwide_row and
                            nationwide_row.exports is defined else 0) }}</td>
                        <td class="value-cell">{{ "%.1f"|format(nationwide_row.price if nationwide_row and
                            nationwide_row.price is defined else 0) }}</td>
                        <td class="value-cell">{{ "%.1f"|format(nationwide_row.employment if nationwide_row and
                            nationwide_row.employment is defined else 0) }}</td>
                    </tr>

                    {% set region_groups = [
                    {'name': '경인', 'regions': ['서울', '인천', '경기']},
                    {'name': '충청', 'regions': ['대전', '세종', '충북', '충남']},
                    {'name': '호남', 'regions': ['광주', '전북', '전남', '제주']},
                    {'name': '동북', 'regions': ['대구', '경북', '강원']},
                    {'name': '동남', 'regions': ['부산', '울산', '경남']}
                    ] %}
                    {% for group in region_groups %}
                    {% for region_name in group.regions %}
                    {% set row = (data_rows | selectattr('region_name', 'equalto', region_name) | list | first) %}
                    <tr>
                        {% if loop.first %}
                        <td rowspan="{{ group.regions|length }}" class="group-cell" style="width: 40px;">{{ group.name
                            }}</td>
                        {% endif %}
                        <td class="region-cell" style="width: 50px;">{{ row.region_display if row and row.region_display
                            is defined and row.region_display else region_name }}</td>
                        <td
                            class="value-cell {% if row and row.mining_production >= 0 %}value-increase{% else %}value-decrease{% endif %}">
                            {{ "%.1f"|format(row.mining_production if row and row.mining_production is defined else 0)
                            }}</td>
                        <td
                            class="value-cell {% if row and row.service_production >= 0 %}value-increase{% else %}value-decrease{% endif %}">
                            {{ "%.1f"|format(row.service_production if row and row.service_production is defined else 0)
                            }}</td>
                        <td
                            class="value-cell {% if row and row.retail_sales >= 0 %}value-increase{% else %}value-decrease{% endif %}">
                            {{ "%.1f"|format(row.retail_sales if row and row.retail_sales is defined else 0) }}</td>
                        <td
                            class="value-cell {% if row and row.exports >= 0 %}value-increase{% else %}value-decrease{% endif %}">
                            {{ "%.1f"|format(row.exports if row and row.exports is defined else 0) }}</td>
                        <td class="value-cell">{{ "%.1f"|format(row.price if row and row.price is defined else 0) }}
                        </td>
                        <td
                            class="value-cell {% if row and row.employment >= 0 %}value-increase{% else %}value-decrease{% endif %}">
                            {{ "%.1f"|format(row.employment if row and row.employment is defined else 0) }}</td>
                    </tr>
                    {% endfor %}
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</body>

</html>