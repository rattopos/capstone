{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "요약-소비건설 스키마",
  "description": "지역경제동향 요약 - 소비/건설 부문 생성을 위한 데이터 스키마",
  
  "type": "object",
  "required": ["report_info", "retail_sales", "construction", "page_number"],
  
  "properties": {
    "report_info": {
      "type": "object",
      "description": "보고서 기본 정보",
      "required": ["year", "quarter"],
      "properties": {
        "year": {
          "type": "integer",
          "description": "보고서 기준 연도",
          "example": 2025
        },
        "quarter": {
          "type": "integer",
          "description": "보고서 기준 분기",
          "enum": [1, 2, 3, 4],
          "example": 2
        }
      }
    },
    
    "retail_sales": {
      "type": "object",
      "description": "소매판매 데이터",
      "required": ["nationwide", "increase_regions", "decrease_regions", "increase_count", "decrease_count", "chart_data"],
      "properties": {
        "nationwide": {
          "type": "object",
          "description": "전국 데이터",
          "required": ["index", "change"],
          "properties": {
            "index": {
              "type": "number",
              "description": "소매판매액지수 (2020=100)",
              "example": 101.8
            },
            "change": {
              "type": "number",
              "description": "전년동분기대비 증감률 (%)",
              "example": -0.2
            }
          }
        },
        "increase_regions": {
          "type": "array",
          "description": "증가 지역 (증가율 높은 순)",
          "items": {
            "$ref": "#/definitions/region_data"
          }
        },
        "decrease_regions": {
          "type": "array",
          "description": "감소 지역 (감소율 높은 순, 절대값 기준)",
          "items": {
            "$ref": "#/definitions/region_data"
          }
        },
        "increase_count": {
          "type": "integer",
          "description": "증가 지역 수",
          "example": 11
        },
        "decrease_count": {
          "type": "integer",
          "description": "감소 지역 수",
          "example": 6
        },
        "chart_data": {
          "type": "array",
          "description": "차트용 시도별 데이터 (순서대로)",
          "items": {
            "$ref": "#/definitions/chart_region_data"
          }
        }
      }
    },
    
    "construction": {
      "type": "object",
      "description": "건설수주 데이터",
      "required": ["nationwide", "increase_regions", "decrease_regions", "increase_count", "decrease_count", "chart_data"],
      "properties": {
        "nationwide": {
          "type": "object",
          "description": "전국 데이터",
          "required": ["amount", "change"],
          "properties": {
            "amount": {
              "type": "string",
              "description": "건설수주액 (조원)",
              "example": "47.1"
            },
            "change": {
              "type": "number",
              "description": "전년동분기대비 증감률 (%)",
              "example": -8.4
            }
          }
        },
        "increase_regions": {
          "type": "array",
          "description": "증가 지역 (증가율 높은 순)",
          "items": {
            "$ref": "#/definitions/region_data"
          }
        },
        "decrease_regions": {
          "type": "array",
          "description": "감소 지역 (감소율 높은 순, 절대값 기준)",
          "items": {
            "$ref": "#/definitions/region_data"
          }
        },
        "increase_count": {
          "type": "integer",
          "description": "증가 지역 수",
          "example": 5
        },
        "decrease_count": {
          "type": "integer",
          "description": "감소 지역 수",
          "example": 12
        },
        "chart_data": {
          "type": "array",
          "description": "차트용 시도별 데이터 (순서대로)",
          "items": {
            "$ref": "#/definitions/construction_chart_data"
          }
        }
      }
    },
    
    "page_number": {
      "type": "integer",
      "description": "페이지 번호",
      "example": 3
    }
  },
  
  "definitions": {
    "region_data": {
      "type": "object",
      "required": ["name", "value"],
      "properties": {
        "name": {
          "type": "string",
          "description": "지역명",
          "example": "울산"
        },
        "value": {
          "type": "number",
          "description": "증감률 (%)",
          "example": 5.4
        }
      }
    },
    "chart_region_data": {
      "type": "object",
      "required": ["name", "index", "change"],
      "properties": {
        "name": {
          "type": "string",
          "description": "지역명 (약어)",
          "example": "전국"
        },
        "index": {
          "type": "number",
          "description": "소매판매액지수",
          "example": 101.8
        },
        "change": {
          "type": "number",
          "description": "전년동분기대비 증감률 (%)",
          "example": -0.2
        },
        "group": {
          "type": "string",
          "description": "지역 그룹명 (선택, 첫 번째 지역에만 표시)",
          "example": "경인"
        }
      }
    },
    "construction_chart_data": {
      "type": "object",
      "required": ["name", "amount", "change"],
      "properties": {
        "name": {
          "type": "string",
          "description": "지역명 (약어)",
          "example": "전국"
        },
        "amount": {
          "type": "string",
          "description": "건설수주액 (백억원)",
          "example": "4,713"
        },
        "amount_normalized": {
          "type": "number",
          "description": "차트 높이 정규화 값 (0-100)",
          "example": 100
        },
        "change": {
          "type": "number",
          "description": "전년동분기대비 증감률 (%)",
          "example": -8.4
        },
        "group": {
          "type": "string",
          "description": "지역 그룹명 (선택, 첫 번째 지역에만 표시)",
          "example": "경인"
        }
      }
    }
  },
  
  "data_sources": {
    "description": "데이터 소스 매핑",
    "retail_sales": {
      "source": "consumption_data.json",
      "fields": {
        "nationwide.index": "nationwide_data.sales_index",
        "nationwide.change": "nationwide_data.growth_rate",
        "increase_regions": "regional_data.increase_regions",
        "decrease_regions": "regional_data.decrease_regions"
      }
    },
    "construction": {
      "source": "construction_data.json",
      "note": "건설동향 데이터 파일 필요"
    }
  },
  
  "example": {
    "report_info": {
      "year": 2025,
      "quarter": 2
    },
    "retail_sales": {
      "nationwide": {
        "index": 101.8,
        "change": -0.2
      },
      "increase_regions": [
        {"name": "울산", "value": 5.4},
        {"name": "인천", "value": 4.9},
        {"name": "세종", "value": 3.5}
      ],
      "decrease_regions": [
        {"name": "제주", "value": -2.3},
        {"name": "경북", "value": -1.8},
        {"name": "서울", "value": -1.8}
      ],
      "increase_count": 11,
      "decrease_count": 6,
      "chart_data": [
        {"name": "전국", "index": 101.8, "change": -0.2},
        {"name": "서울", "index": 94.5, "change": -1.8, "group": "경인"},
        {"name": "인천", "index": 102.3, "change": 4.9},
        {"name": "경기", "index": 96.5, "change": 0.3}
      ]
    },
    "construction": {
      "nationwide": {
        "amount": "47.1",
        "change": -8.4
      },
      "increase_regions": [
        {"name": "대구", "value": 370.9},
        {"name": "경남", "value": 91.9},
        {"name": "부산", "value": 73.8}
      ],
      "decrease_regions": [
        {"name": "제주", "value": -70.6},
        {"name": "세종", "value": -67.5},
        {"name": "광주", "value": -56.4}
      ],
      "increase_count": 5,
      "decrease_count": 12,
      "chart_data": [
        {"name": "전국", "amount": "4,713", "amount_normalized": 100, "change": -8.4},
        {"name": "서울", "amount": "1,033", "amount_normalized": 22, "change": 29.2, "group": "경인"},
        {"name": "인천", "amount": "207", "amount_normalized": 4, "change": -50.0}
      ]
    },
    "page_number": 3
  }
}

