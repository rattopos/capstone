<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>통계표 목차 - {{ year }}년 {{ quarter }}분기 ({{ report_info.year }}년 {{ report_info.quarter }}/4분기)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: "Malgun Gothic", serif;
            font-size: 11pt;
            line-height: 1.4;
            color: #000;
            background: #fff;
        }
        
        .page {
            width: 100%;
            padding: 0;
            margin: 0;
            background: #fff;
            position: relative;
        }
        
        /* 헤더 영역 */
        .header {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 50px;
            padding-top: 10mm;
        }
        
        .header-icon {
            width: 40px;
            height: 40px;
            background: #5577aa;
            border-radius: 6px;
            margin-right: 12px;
            box-shadow: 1px 1px 3px rgba(0,0,0,0.2);
        }
        
        .header-title {
            background: #cccccc;
            color: #000;
            font-family: "Malgun Gothic", serif;
            font-size: 11pt;
            font-weight: bold;
            letter-spacing: 25px;
            padding: 10px 80px 10px 100px;
            border-radius: 2px;
        }
        
        /* 목차 리스트 */
        .toc-list {
            list-style: none;
            padding: 20px 50px;
        }
        
        .toc-list li {
            font-size: 11pt;
            padding: 15px 0;
            display: flex;
            align-items: baseline;
            line-height: 1.6;
        }
        
        .toc-number {
            min-width: 40px;
            font-weight: normal;
        }
        
        .toc-title {
            min-width: 120px;
            white-space: nowrap;
        }
        
        .toc-dots {
            flex: 1;
            overflow: hidden;
            margin-left: 10px;
            font-family: serif;
            letter-spacing: 1px;
            color: #666;
        }
        
        .toc-dots::after {
            content: "…………………………………………………………………………………………………………";
        }
        
        /* 참고 항목 */
        .toc-reference {
            margin-top: 15px;
            padding-left: 50px;
        }
        
        .toc-reference li {
            color: #000;
        }
        
        
        @media print {
            body {
                background: none;
            }
            .page {
                margin: 0;
                padding: 0;
            }
        }
        
    </style>
</head>
<body>
    <div class="page toc-page">
        <div class="header">
            <div class="header-icon"></div>
            <div class="header-title">통 계 표</div>
        </div>
        
        <ol class="toc-list">
            {% if toc_entries %}
            {% for entry in toc_entries %}
            <li>
                <span class="toc-number">{{ entry.number }}.</span>
                <span class="toc-title">{{ entry.name }}</span>
                <span class="toc-dots"></span>
            </li>
            {% endfor %}
            {% else %}
            {# 페이지 단위 기본 목록 (각 통계표 2페이지) #}
            {% set stat_items = [
                ('광공업생산지수', 2),
                ('서비스업생산지수', 2),
                ('소매판매액지수', 2),
                ('건설수주액', 2),
                ('고용률', 2),
                ('실업률', 2),
                ('국내 인구이동', 2),
                ('수출액', 2),
                ('수입액', 2),
                ('소비자물가지수', 2)
            ] %}
            {% set ns = namespace(num=1) %}
            {% for name, pages in stat_items %}
            {% for p in range(1, pages + 1) %}
            <li>
                <span class="toc-number">{{ ns.num }}.</span>
                <span class="toc-title">{{ name }} ({{ p }})</span>
                <span class="toc-dots"></span>
            </li>
            {% set ns.num = ns.num + 1 %}
            {% endfor %}
            {% endfor %}
            {% endif %}
        </ol>
        
        <ul class="toc-list toc-reference">
            {% if grdp_entries %}
            {% for entry in grdp_entries %}
            <li>
                <span class="toc-number">&lt;참고&gt;</span>
                <span class="toc-title">{{ entry.name }}</span>
                <span class="toc-dots"></span>
            </li>
            {% endfor %}
            {% else %}
            {# 페이지 단위 GRDP (2페이지) #}
            <li>
                <span class="toc-number">&lt;참고&gt;</span>
                <span class="toc-title">분기 지역내총생산(GRDP) (1)</span>
                <span class="toc-dots"></span>
            </li>
            <li>
                <span class="toc-number">&lt;참고&gt;</span>
                <span class="toc-title">분기 지역내총생산(GRDP) (2)</span>
                <span class="toc-dots"></span>
            </li>
            {% endif %}
        </ul>
        
</body>
</html>
